(this.webpackJsonpsakkaku=this.webpackJsonpsakkaku||[]).push([[0],{153:function(e,t,n){e.exports={layout:"roller_layout__2TyHW"}},154:function(e,t,n){e.exports={submit:"Intent_submit__3pMAY"}},162:function(e,t,n){e.exports=n.p+"static/media/black.f14fed51.png"},163:function(e,t,n){e.exports=n.p+"static/media/blackot.3a5ad7bb.png"},164:function(e,t,n){e.exports=n.p+"static/media/blackst.3fad8195.png"},165:function(e,t,n){e.exports=n.p+"static/media/blacket.f0ca3076.png"},166:function(e,t,n){e.exports=n.p+"static/media/blacko.e44a1dd0.png"},167:function(e,t,n){e.exports=n.p+"static/media/blacks.216d4546.png"},168:function(e,t,n){e.exports=n.p+"static/media/white.c24c0c51.png"},169:function(e,t,n){e.exports=n.p+"static/media/whitee.7755ca79.png"},170:function(e,t,n){e.exports=n.p+"static/media/whiteet.d10cd0cc.png"},171:function(e,t,n){e.exports=n.p+"static/media/whiteo.1e81fee0.png"},172:function(e,t,n){e.exports=n.p+"static/media/whites.7cb9db03.png"},173:function(e,t,n){e.exports=n.p+"static/media/whiteso.f76a057b.png"},174:function(e,t,n){e.exports=n.p+"static/media/whitest.05051e66.png"},195:function(e,t,n){e.exports=n.p+"static/media/logo.20098cc4.png"},202:function(e,t,n){e.exports=n(363)},207:function(e,t,n){},208:function(e,t,n){},363:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(17),i=n.n(c),o=(n(207),n(57)),l=(n(208),n(42)),s=n(153),u=n.n(s),d=n(373),m=n(368),p=n(364),f=n(375),g=n(376),b=n(371),E=n(135),v=n(154),h=n.n(v),y=d.a.TextArea,k={labelCol:{span:8},wrapperCol:{span:16}},x={labelCol:{span:0},wrapperCol:{span:24}},j=[{required:!0,message:"Please fill this field"}],O=function(e){var t=e.onFinish,n=e.values,a=e.loading;return r.a.createElement(m.a,Object.assign({},k,{initialValues:n,onFinish:function(e){t(Object(l.a)({},e,{modifiers:[e.modifier,e.compromised&&"compromised",e.void&&"void"].filter(Boolean)}))}}),r.a.createElement(m.a.Item,{label:"Campaign",name:"campaign",rules:j},r.a.createElement(d.a,null)),r.a.createElement(m.a.Item,{label:"Character",name:"character",rules:j},r.a.createElement(d.a,null)),r.a.createElement(m.a.Item,{label:"Description",name:"description",rules:j},r.a.createElement(y,null)),r.a.createElement(p.a,null),r.a.createElement(m.a.Item,{label:"TN",name:"tn",rules:j},r.a.createElement(f.a,{min:1})),r.a.createElement(m.a.Item,{label:"Ring",name:"ring",rules:j},r.a.createElement(f.a,{min:1,max:5})),r.a.createElement(m.a.Item,{label:"Skill",name:"skill",rules:j},r.a.createElement(f.a,{min:0,max:5})),r.a.createElement(p.a,null),r.a.createElement(m.a.Item,{label:"Void?",name:"void",valuePropName:"checked"},r.a.createElement(g.a,null)),r.a.createElement(m.a.Item,{label:"Advantage / Disadvantage",name:"modifier"},r.a.createElement(b.a.Group,null,r.a.createElement(b.a.Button,{value:""},"None"),r.a.createElement(b.a.Button,{value:"distinction"},"Distinction"),r.a.createElement(b.a.Button,{value:"adversity"},"Adversity"))),r.a.createElement(m.a.Item,{label:"Compromised?",name:"compromised",valuePropName:"checked"},r.a.createElement(g.a,null)),r.a.createElement(p.a,null),r.a.createElement(m.a.Item,x,r.a.createElement(E.a,{type:"primary",htmlType:"submit",className:h.a.submit,disabled:a},"Roll")))},w=n(95),_=n(125),I=n(65),C=n.n(I),S=n(98),F=function(){var e=Object(S.a)(C.a.mark((function e(t){var n,a,r,c,i,o,l,s;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.uri,a=t.method,r=t.body,c=t.success,i=t.error,o={Accept:"application/json"},r&&(o["Content-Type"]="application/json"),e.prev=3,e.next=6,fetch("".concat("/api").concat(n),{method:a,headers:o,body:r?JSON.stringify(r):void 0});case 6:if((l=e.sent).ok){e.next=9;break}throw new Error("Bad status: ".concat(l.status));case 9:return e.next=11,l.json();case 11:s=e.sent,c(s),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),i?i(e.t0):console.error(e.t0);case 18:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(S.a)(C.a.mark((function e(t){var n,a,r,c;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.uri,a=t.body,r=t.success,c=t.error,e.abrupt("return",F({uri:n,method:"POST",body:a,success:r,error:c}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(S.a)(C.a.mark((function e(t){var n,a,r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.uri,a=t.success,r=t.error,e.abrupt("return",F({uri:n,method:"GET",success:a,error:r}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(S.a)(C.a.mark((function e(t){var n,a,r,c,i,o;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.uri,a=t.body,r=t.success,c=t.error,e.prev=1,e.next=4,fetch("".concat("/api").concat(n),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-XSRF-TOKEN":decodeURIComponent(document.cookie.match("(^|;) ?XSRF-TOKEN=([^;]*)(;|$)")[2])},body:JSON.stringify(a)});case 4:if((i=e.sent).ok){e.next=7;break}throw new Error("Bad status: ".concat(i.status));case 7:return e.next=9,i.json();case 9:o=e.sent,r(o),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),c?c(e.t0):console.error(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),D=Object(_.b)({name:"roll",initialState:{campaign:"Test campaign",character:"Test character",description:"Test roll",tn:2,ring:2,skill:2,modifiers:[],dices:[],metadata:{},loading:!1},reducers:{softReset:function(e){e.dices=[],e.metadata={}},setParameters:function(e,t){var n=t.payload,a=n.campaign,r=n.character,c=n.description,i=n.tn,o=n.ring,l=n.skill,s=n.modifiers;e.campaign=a,e.character=r,e.description=c,e.tn=i,e.ring=o,e.skill=l,e.modifiers=s},updateDices:function(e,t){e.dices=t.payload},setMetadata:function(e,t){e.metadata=t.payload},setLoading:function(e,t){e.loading=t.payload},setId:function(e,t){e.id=t.payload}}}),R=D.actions,B=R.setParameters,L=R.updateDices,q=R.setMetadata,A=R.setLoading,Y=R.setId,M=D.actions.softReset,X=function(e,t,n){return function(a){a(A(!0));var r=function(e){a(L(e.dices)),a(q(e.metadata)),a(A(!1))},c=e.id;if(c)P({uri:"/ffg/l5r/rolls/".concat(c,"/reroll"),body:{positions:t,modifier:n},success:r});else{var i=e.tn,o=e.ring,l=e.skill,s=e.modifiers,u=e.dices;N({uri:"/public/ffg/l5r/rolls/reroll",body:{roll:{parameters:{tn:i,ring:o,skill:l,modifiers:s},dices:u},positions:t,modifier:n},success:r})}}},G=function(e,t){return function(n){n(A(!0));var a=function(e){n(L(e.dices)),n(A(!1))},r=e.id;if(r)P({uri:"/ffg/l5r/rolls/".concat(r,"/keep"),body:{positions:t},success:a});else{var c=e.tn,i=e.ring,o=e.skill,l=e.modifiers,s=e.dices,u=e.metadata;N({uri:"/public/ffg/l5r/rolls/keep",body:{roll:{parameters:{tn:c,ring:i,skill:o,modifiers:l},dices:s,metadata:u},positions:t},success:a})}}},H=function(e){return e.roll},J=D.reducer,W=n(69),K=n(74),U=n(367),V=n(84),Q=n.n(V),$=n(3),z=n.n($),Z=n(370),ee=n(162),te=n.n(ee),ne=n(163),ae=n.n(ne),re=n(164),ce=n.n(re),ie=n(165),oe=n.n(ie),le=n(166),se=n.n(le),ue=n(167),de=n.n(ue),me=n(168),pe=n.n(me),fe=n(169),ge=n.n(fe),be=n(170),Ee=n.n(be),ve=n(171),he=n.n(ve),ye=n(172),ke=n.n(ye),xe=n(173),je=n.n(xe),Oe=n(174),we=n.n(Oe),_e=function(e){var t=e.type,n=e.value,a=n.opportunity,r=n.strife,c=n.success,i=n.explosion;return"skill"===t?i?r?Ee.a:ge.a:c?a?je.a:r?we.a:ke.a:a?he.a:pe.a:r?i?oe.a:c?ce.a:ae.a:c?de.a:a?se.a:te.a},Ie=function(e){var t=e.dice,n=function(e){var t=e.value,n=t.opportunity,a=t.strife,r=t.success,c=t.explosion;return[n&&"Opportunity: ".concat(n),r&&"Success: ".concat(r),c&&"Explosion: ".concat(c),a&&"Strife: ".concat(a)].filter(Boolean).join("; ")||"Nothing"}(t);return r.a.createElement(Z.a,{src:_e(t),alt:n,title:n,preview:!1})},Ce=function(e){var t=e.dices;if(!(null===t||void 0===t?void 0:t.length))return null;var n=t.map((function(e,t){return{key:t.toString(),dice:e,selectable:e.selectable,selected:e.selected,toggle:e.toggle,disabled:e.disabled}}));return r.a.createElement(U.b,{grid:{gutter:0,column:10},dataSource:n,renderItem:function(e){var t,n=e.key,a=e.dice,c=e.selectable,i=e.selected,o=e.toggle,l=e.disabled;return r.a.createElement(U.b.Item,{key:n,className:z()(Q.a.dice,(t={},Object(K.a)(t,Q.a.selectable,c),Object(K.a)(t,Q.a.selected,i),Object(K.a)(t,Q.a.unselectable,l),Object(K.a)(t,Q.a.rerolled,"rerolled"===a.status),t)),onClick:c?o:void 0},r.a.createElement(Ie,{dice:a}))}})},Se=n(369),Fe=Se.a.Paragraph,Ne=function(e){var t=e.dices,n=e.text,a=e.footer;return r.a.createElement("div",null,r.a.createElement(Fe,null,n),r.a.createElement(Ce,{dices:t}),a)},Te=function(e){var t=e.dices,n=e.max,c=e.onFinish,i=e.compromised,s=e.trulyCompromised,u=e.loading,d=Object(a.useState)([]),m=Object(o.a)(d,2),p=m[0],f=m[1],g=n>p.length,b=s?"You cannot keep any dice due to being compromised.":"You can choose up to ".concat(n," dice").concat(n>1?"s":""," to keep (min 1).");return r.a.createElement(Ne,{text:b,dices:t.map((function(e,t){var n=p.includes(t),a="pending"===e.status&&(!i||!e.value.strife),r=(n||g)&&a;return Object(l.a)({},e,{selectable:r,selected:n,disabled:!r,toggle:function(){return function(e){return p.includes(e)?f(p.filter((function(t){return t!==e}))):f([].concat(Object(W.a)(p),[e]))}(t)}})})),footer:(p.length>=1||s)&&r.a.createElement(E.a,{type:"primary",onClick:function(){return c(p)},disabled:u},"Continue")})},Pe=function(e){var t=e.dices,n=e.onFinish,c=e.compromised,i=e.loading,s=Object(a.useState)([]),u=Object(o.a)(s,2),d=u[0],m=u[1];return r.a.createElement(Ne,{text:"Select which explosions you wish to keep (if any):",dices:t.map((function(e,t){var n="pending"===e.status&&(!c||!e.value.strife);return Object(l.a)({},e,{selectable:n,selected:"kept"===e.status||d.includes(t),disabled:!n&&"kept"!==e.status,toggle:function(){return function(e){return d.includes(e)?m(d.filter((function(t){return t!==e}))):m([].concat(Object(W.a)(d),[e]))}(t)}})})),footer:r.a.createElement(E.a,{type:"primary",onClick:function(){return n(d)},disabled:i},"Continue")})},De=function(e){var t=e.dices,n=e.trulyCompromised?"You couldn't keep any dice due to being compromised.":"You have kept:";return r.a.createElement(Ne,{text:n,dices:t.map((function(e){var t="kept"===e.status;return Object(l.a)({},e,{disabled:!t,selected:t})}))})},Re=Se.a.Text,Be=function(e){var t=e.dices,n=e.tn,a=[{type:"Successes",count:t.reduce((function(e,t){return e+(t.value.explosion||0)+(t.value.success||0)}),0),target:n},{type:"Strifes",count:t.reduce((function(e,t){return e+(t.value.strife||0)}),0)},{type:"Opportunities",count:t.reduce((function(e,t){return e+(t.value.opportunity||0)}),0)}];return r.a.createElement(U.b,{grid:{gutter:16,column:3},dataSource:a,renderItem:function(e){var t=e.type,n=e.count,a=e.target;return r.a.createElement(U.b.Item,null,r.a.createElement(Re,{strong:!0,type:a&&(n>=a?"success":"warning")},"".concat(t,": ").concat(n)),a&&r.a.createElement(Re,null," (required: ".concat(a,")")))}})},Le=function(e){var t=e.dices,n=e.onFinish,c=e.loading,i=Object(a.useState)([]),s=Object(o.a)(i,2),u=s[0],d=s[1];return r.a.createElement(Ne,{text:"You can choose up to ".concat(2," dices to reroll."),dices:t.map((function(e,t){var n=u.includes(t),a=n||u.length<2;return Object(l.a)({},e,{selectable:a,selected:n,disabled:!a,toggle:function(){return function(e){return u.includes(e)?d(u.filter((function(t){return t!==e}))):d([].concat(Object(W.a)(u),[e]))}(t)}})})),footer:r.a.createElement(E.a,{type:"primary",onClick:function(){return n(u)},disabled:c},"Continue")})},qe=function(e){var t=e.dices,n=e.onFinish,c=e.loading,i=Object(a.useState)([]),s=Object(o.a)(i,2),u=s[0],d=s[1],m=t.filter((function(e){var t=e.value;return t.success||t.explosion})),p=Math.min(2,m.length);return r.a.createElement(Ne,{text:"You must reroll two success dices (if possible).",dices:t.map((function(e,t){var n=u.includes(t),a=(e.value.success||e.value.explosion)&&(n||u.length<2);return Object(l.a)({},e,{selectable:a,selected:n,disabled:!a,toggle:function(){return function(e){return u.includes(e)?d(u.filter((function(t){return t!==e}))):d([].concat(Object(W.a)(u),[e]))}(t)}})})),footer:u.length>=p&&r.a.createElement(E.a,{type:"primary",onClick:function(){return n(u)},disabled:c},"Continue")})},Ae=n(366),Ye=n(374),Me=Se.a.Title,Xe=function(e){var t=e.campaign,n=e.character,a=e.description,c=e.tn,i=e.ring,o=e.skill,l=e.modifiers,s=e.player,u=[l.includes("void")&&"Void Point spent",l.includes("compromised")&&"Compromised",l.includes("adversity")&&"Adversity applies",l.includes("distinction")&&"Distinction applies"].filter(Boolean).join(" \u2013 ");return r.a.createElement(Ae.a,null,r.a.createElement(Me,{level:2},"L5R Check"),r.a.createElement(Ye.a,{title:"Context",column:3},r.a.createElement(Ye.a.Item,{label:"Campaign"},t),r.a.createElement(Ye.a.Item,{label:"Character"},n),s&&r.a.createElement(Ye.a.Item,{label:"Player"},s.name)),r.a.createElement(Ye.a,{title:"Parameters",column:2},r.a.createElement(Ye.a.Item,{label:"Description",span:2},a),r.a.createElement(Ye.a.Item,{label:"TN"},c),r.a.createElement(Ye.a.Item,{label:"Dice Pool"},"Ring ".concat(i,", Skill ").concat(o)),u&&r.a.createElement(Ye.a.Item,{label:"Special",span:2},u)))},Ge=function(e){var t,n=e.user,a=Object(w.c)(H),c=Object(w.b)(),i=a.dices,o=a.tn,s=a.metadata,d=a.modifiers,m=a.ring,p=a.loading,f=i.length>0,g=f&&i.some((function(e){return"pending"===e.status})),b=i.filter((function(e){return"kept"===e.status})),v=b.length>0,h=(null===s||void 0===s||null===(t=s.rerolls)||void 0===t?void 0:t.length)||!(d.includes("adversity")||d.includes("distinction")),y=d.includes("compromised"),k=y&&f&&h&&!v&&i.filter((function(e){return"pending"===e.status})).every((function(e){return e.value.strife})),x=d.includes("void");return r.a.createElement("div",{className:u.a.layout},r.a.createElement(r.a.Fragment,null,!f&&r.a.createElement(O,{onFinish:function(e){return c(function(e,t){return function(n){n(A(!0)),n(B(e));var a=e.tn,r=e.ring,c=e.skill,i=e.modifiers,o=e.campaign,l=e.character,s=e.description;t?P({uri:"/ffg/l5r/rolls/create",body:{tn:a,ring:r,skill:c,modifiers:i,campaign:o,character:l,description:s},success:function(e){n(L(e.dices)),n(Y(e.id)),n(A(!1))}}):N({uri:"/public/ffg/l5r/rolls/create",body:{tn:a,ring:r,skill:c,modifiers:i},success:function(e){n(L(e.dices)),n(A(!1))}})}}(Object(l.a)({},a,{},e),n))},values:a,loading:p}),f&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Xe,a),!h&&r.a.createElement(r.a.Fragment,null,d.includes("distinction")&&r.a.createElement(Le,{dices:i,onFinish:function(e){return c(X(a,e,"distinction"))},loading:p}),d.includes("adversity")&&r.a.createElement(qe,{dices:i,onFinish:function(e){return c(X(a,e,"adversity"))},loading:p})),h&&r.a.createElement(r.a.Fragment,null,g?r.a.createElement(r.a.Fragment,null,!v&&r.a.createElement(Te,{dices:i,max:x?m+1:m,onFinish:function(e){return c(G(a,e))},compromised:y,trulyCompromised:k,loading:p}),v&&r.a.createElement(Pe,{dices:i,onFinish:function(e){return c(G(a,e))},compromised:y,loading:p})):r.a.createElement(r.a.Fragment,null,r.a.createElement(De,{dices:i,trulyCompromised:k}),r.a.createElement(Be,{dices:b,tn:o}),r.a.createElement(E.a,{type:"primary",onClick:function(){return c(M())}},"Reroll"))))))},He=n(365),Je=n(372),We=n(195),Ke=n.n(We),Ue=n(99),Ve=n.n(Ue),Qe=He.a.Header,$e=He.a.Content,ze=He.a.Footer,Ze=function(e){var t=e.user,n=e.children;return r.a.createElement(He.a,{className:Ve.a.layout},r.a.createElement(Qe,null,r.a.createElement(Je.a,{theme:"dark",mode:"horizontal"},r.a.createElement(Je.a.Item,{className:Ve.a.logo},r.a.createElement("a",{href:"/"},r.a.createElement("img",{alt:"Logo",src:Ke.a}))),r.a.createElement(Je.a.Item,null,r.a.createElement("a",{href:"/"},"Roll")),r.a.createElement(Je.a.Item,{className:Ve.a.login},t?r.a.createElement("a",{href:"/user/profile"},t.name):r.a.createElement("a",{href:"/login"},"Login")))),r.a.createElement($e,null,n),r.a.createElement(ze,{className:Ve.a.footer},"Sakkaku Project / 2020 / ",r.a.createElement("a",{href:"mailto:contact.sakkaku@gmail.com"},"Issue? Suggestion?")))},et=function(){var e=Object(a.useState)(),t=Object(o.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){T({uri:"/user",success:function(e){c(e)},error:function(e){}})}),[]),r.a.createElement(Ze,{user:n},r.a.createElement(Ge,{user:n}))},tt=Object(_.a)({reducer:{roll:J}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(w.a,{store:tt},r.a.createElement(et,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},84:function(e,t,n){e.exports={dice:"Dices_dice__cqowQ",selectable:"Dices_selectable__2UH3q",selected:"Dices_selected__1Gb1I",unselectable:"Dices_unselectable__KQSGp",rerolled:"Dices_rerolled__2e0qS"}},99:function(e,t,n){e.exports={layout:"Layout_layout__UFIxE",logo:"Layout_logo__1Oa8g",footer:"Layout_footer__1d2pN",login:"Layout_login__2luPa"}}},[[202,1,2]]]);
//# sourceMappingURL=main.c9ca4d9a.chunk.js.map