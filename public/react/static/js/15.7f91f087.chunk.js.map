{"version":3,"sources":["webpack:///./src/features/probabilities/Calculator.module.less?77b6","features/probabilities/Calculator.module.less","features/probabilities/worker.js","features/probabilities/Calculator.js"],"names":["content","module","i","options","transform","undefined","locals","exports","___CSS_LOADER_API_IMPORT___","push","addMethods","methods","w","Worker","name","workerInstance","Paragraph","Typography","Text","cache","keify","mathParams","JSON","stringify","load","params","computeAndCacheCumulativeSuccess","a","callback","asyncCumulativeSuccess","intervalID","setInterval","result","clearInterval","TextOutput","ring","skill","tn","unskilled_assist","skilled_assist","compromised","useState","loading","setLoading","setResult","useEffect","worker","addEventListener","message","data","type","save","Math","abs","toFixed","terminate","every","n","Number","isInteger","keptDiceCount","setFromCache","cachedResult","setTimeout","StaticTextOutput","strong","Calculator","Form","useForm","form","initialValues","values","setValues","layout","onValuesChange","_","className","styles","Item","label","min","max","valuePropName"],"mappings":"wFACA,IAAIA,EAAU,EAAQ,KAEA,kBAAZA,IAAsBA,EAAU,CAAC,CAACC,EAAOC,EAAIF,EAAS,MAOhE,IAAIG,EAAU,CAAC,KAAM,EAErB,eAPIC,EAQJ,gBAAqBC,GAER,EAAQ,IAAR,CAAgEL,EAASG,GAEnFH,EAAQM,SAAQL,EAAOM,QAAUP,EAAQM,S,qBCf5CC,EADkC,EAAQ,IAChCC,EAA4B,IAE9BC,KAAK,CAACR,EAAOC,EAAI,wXAAyX,KAElZK,EAAQD,OAAS,CAChB,KAAQ,2BAETL,EAAOM,QAAUA,G,oBCRb,IAAIG,EAAa,EAAQ,KACrBC,EAAU,CAAC,0BACfV,EAAOM,QAAU,WAChB,IAAIK,EAAI,IAAIC,OAAO,IAA0B,iCAAkC,CAAEC,KAAM,qBAGvF,OAFAJ,EAAWE,EAAGD,GAEPC,I,4CCCRG,E,2IAFIC,EAAoBC,IAApBD,UAAWE,EAASD,IAATC,KAGfC,EAAQ,GACNC,EAAQ,SAACC,GAAD,OAAgBC,KAAKC,UAAUF,IACvCG,EAAO,SAACC,GAAD,OAAYN,EAAMC,EAAMK,KAK/BC,EAAgC,uCAAG,iCAAAC,EAAA,sDAASN,EAAT,EAASA,WAAYO,EAArB,EAAqBA,SAC5Db,EAAec,uBAAuBR,GAEhCS,EAAaC,aAAY,WAC7B,IAAMC,EAASR,EAAKH,GAChBW,IACFC,cAAcH,GACdF,EAASI,OAP0B,2CAAH,sDAYhCE,EAAa,SAAC,GAOb,IANLC,EAMI,EANJA,KACAC,EAKI,EALJA,MACAC,EAII,EAJJA,GACAC,EAGI,EAHJA,iBACAC,EAEI,EAFJA,eACAC,EACI,EADJA,YACI,EAC0BC,oBAAS,GADnC,mBACGC,EADH,KACYC,EADZ,OAEwBF,qBAFxB,mBAEGT,EAFH,KAEWY,EAFX,KAqEJ,OAjEAC,qBAAU,WAWR,OAVA9B,EAAiB+B,OACFC,iBAAiB,WAAW,SAACC,GAAa,IAAD,EAGlDA,EADFC,KAAQC,EAF4C,EAE5CA,KAAMzB,EAFsC,EAEtCA,OAAQO,EAF8B,EAE9BA,OAEX,WAATkB,GAjCG,SAACzB,EAAQO,GACpBb,EAAMC,EAAMK,IAAWO,EAkCjBmB,CAAK1B,EADgB,WAA0B,IAAnB2B,KAAKC,IAAIrB,IAAesB,QAAQ,GAAvC,SAIlB,WACLvC,EAAewC,eAEhB,IAEHV,qBAAU,WACR,IACG,CAACR,EAAIF,EAAMC,EAAOG,EAAgBD,GAAkBkB,OACnD,SAACC,GAAD,OAAOC,OAAOC,UAAUF,IAAMA,GAAK,GAAKA,GAAK,OAE/CpB,EAAK,GACLF,EAAO,EAEPQ,GAAW,OAPb,CAWA,IAAMtB,EAAa,CACjBgB,KACAF,KAAMA,EAAOG,EACbF,MAAOA,EAAQG,EACfpC,QAAS,CACPqC,cACAoB,cAAezB,EAAOG,EAAmBC,IAIvCsB,EAAe,WACnB,IAAMC,EAAetC,EAAKH,GAC1B,QAAKyC,IAILlB,EAAUkB,GACVnB,GAAW,IACJ,IAGLkB,MAIJE,YAAW,WACJF,KACHlB,GAAW,KAEZ,KAEHjB,EAAiC,CAC/BL,aACAO,SAAUiC,QAEX,CAAC1B,EAAMC,EAAOC,EAAIC,EAAkBC,EAAgBC,IAGrD,kBAACwB,EAAD,CACEtB,QAASA,EACTV,OAAQA,EACRQ,YAAaA,KAKbwB,EAAmB,SAAC,GAAsC,IAApChC,EAAmC,EAAnCA,OAAQU,EAA2B,EAA3BA,QAASF,EAAkB,EAAlBA,YAC3C,OACE,kBAACxB,EAAD,KACE,kBAACE,EAAD,KACGsB,EAAW,4LAId,kBAACtB,EAAD,CAAM+C,QAAM,GAAEvB,EAAU,kBAAC,IAAD,MAAsBV,GAC9C,kBAACd,EAAD,YA0DSgD,UArDI,WAAO,IAAD,EACRC,IAAKC,UAAbC,EADgB,oBAEjBC,EAAgB,CACpBnC,KAAM,EACNC,MAAO,EACPC,GAAI,EACJC,iBAAkB,EAClBC,eAAgB,EAChBC,aAAa,GARQ,EAUKC,mBAAS6B,GAVd,mBAUhBC,EAVgB,KAURC,EAVQ,KAYvB,OACE,kBAAC,IAAD,CACEC,OAAQ,SACRJ,KAAMA,EACNC,cAAeA,EACfI,eAAgB,SAACC,EAAGJ,GAClBC,EAAUD,IAEZK,UAAWC,IAAOR,MAElB,kBAAC,IAAKS,KAAN,CAAWC,MAAM,OAAOjE,KAAK,QAC3B,kBAAC,IAAD,CAAakE,IAAK,EAAGC,IAAK,MAE5B,kBAAC,IAAKH,KAAN,CAAWC,MAAM,QAAQjE,KAAK,SAC5B,kBAAC,IAAD,CAAakE,IAAK,EAAGC,IAAK,MAE5B,kBAAC,IAAKH,KAAN,CAAWC,MAAM,KAAKjE,KAAK,MACzB,kBAAC,IAAD,CAAakE,IAAK,EAAGC,IAAK,MAE5B,kBAAC,IAAKH,KAAN,CACEC,MAAO,eACPjE,KAAK,cACLoE,cAAc,WAEd,kBAAC,IAAD,OAEF,kBAAC,IAAD,MACA,kBAAC,IAAKJ,KAAN,CAAWC,MAAM,yBAAyBjE,KAAK,oBAC7C,kBAAC,IAAD,CAAakE,IAAK,EAAGC,IAAK,MAE5B,kBAAC,IAAKH,KAAN,CAAWC,MAAM,uBAAuBjE,KAAK,kBAC3C,kBAAC,IAAD,CAAakE,IAAK,EAAGC,IAAK,MAE5B,kBAAC,IAAD,MACA,gCACE,kBAAC/C,EAAeqC","file":"static/js/15.7f91f087.chunk.js","sourcesContent":["\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-9-1!../../../node_modules/less-loader/dist/cjs.js??ref--6-oneOf-9-2!./Calculator.module.less\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-9-1!../../../node_modules/less-loader/dist/cjs.js??ref--6-oneOf-9-2!./Calculator.module.less\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-9-1!../../../node_modules/less-loader/dist/cjs.js??ref--6-oneOf-9-2!./Calculator.module.less\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"._18zXDSuc3aaCF48B0sS5mQ {\\n  margin: 24px auto;\\n  padding: 0 16px;\\n  max-width: 768px;\\n  justify-content: center;\\n}\\n._18zXDSuc3aaCF48B0sS5mQ.ant-form-inline .ant-form-item {\\n  margin-bottom: 8px;\\n}\\n@media (max-width: 576px) {\\n  ._18zXDSuc3aaCF48B0sS5mQ {\\n    justify-content: space-between;\\n  }\\n}\\n._18zXDSuc3aaCF48B0sS5mQ output {\\n  text-align: justify;\\n}\\n\", \"\"]);\n// Exports\nexports.locals = {\n\t\"form\": \"_18zXDSuc3aaCF48B0sS5mQ\"\n};\nmodule.exports = exports;\n","\n\t\t\t\tvar addMethods = require(\"../../../node_modules/workerize-loader/dist/rpc-wrapper.js\")\n\t\t\t\tvar methods = [\"asyncCumulativeSuccess\"]\n\t\t\t\tmodule.exports = function() {\n\t\t\t\t\tvar w = new Worker(__webpack_public_path__ + \"a5adcee4c624519fcde8.worker.js\", { name: \"[hash].worker.js\" })\n\t\t\t\t\taddMethods(w, methods)\n\t\t\t\t\t\n\t\t\t\t\treturn w\n\t\t\t\t}\n\t\t\t","import React, { useState, useEffect } from \"react\";\nimport { Form, InputNumber, Typography, Switch, Divider } from \"antd\";\nimport styles from \"./Calculator.module.less\";\nimport worker from \"workerize-loader!./worker\"; // eslint-disable-line import/no-webpack-loader-syntax\nimport { LoadingOutlined } from \"@ant-design/icons\";\n\nconst { Paragraph, Text } = Typography;\n\nlet workerInstance;\nlet cache = {};\nconst keify = (mathParams) => JSON.stringify(mathParams);\nconst load = (params) => cache[keify(params)];\nconst save = (params, result) => {\n  cache[keify(params)] = result;\n};\n\nconst computeAndCacheCumulativeSuccess = async ({ mathParams, callback }) => {\n  workerInstance.asyncCumulativeSuccess(mathParams);\n\n  const intervalID = setInterval(() => {\n    const result = load(mathParams);\n    if (result) {\n      clearInterval(intervalID);\n      callback(result);\n    }\n  });\n};\n\nconst TextOutput = ({\n  ring,\n  skill,\n  tn,\n  unskilled_assist,\n  skilled_assist,\n  compromised,\n}) => {\n  const [loading, setLoading] = useState(true);\n  const [result, setResult] = useState();\n\n  useEffect(() => {\n    workerInstance = worker();\n    workerInstance.addEventListener(\"message\", (message) => {\n      const {\n        data: { type, params, result },\n      } = message;\n      if (type === \"custom\") {\n        const formattedResult = `${(Math.abs(result) * 100).toFixed(2)}%`;\n        save(params, formattedResult);\n      }\n    });\n    return () => {\n      workerInstance.terminate();\n    };\n  }, []);\n\n  useEffect(() => {\n    if (\n      ![tn, ring, skill, skilled_assist, unskilled_assist].every(\n        (n) => Number.isInteger(n) && n >= 0 && n <= 10\n      ) ||\n      tn < 1 ||\n      ring < 1\n    ) {\n      setLoading(true);\n      return;\n    }\n\n    const mathParams = {\n      tn,\n      ring: ring + unskilled_assist,\n      skill: skill + skilled_assist,\n      options: {\n        compromised,\n        keptDiceCount: ring + unskilled_assist + skilled_assist,\n      },\n    };\n\n    const setFromCache = () => {\n      const cachedResult = load(mathParams);\n      if (!cachedResult) {\n        return false;\n      }\n\n      setResult(cachedResult);\n      setLoading(false);\n      return true;\n    };\n\n    if (setFromCache()) {\n      return;\n    }\n\n    setTimeout(() => {\n      if (!setFromCache()) {\n        setLoading(true);\n      }\n    }, 100);\n\n    computeAndCacheCumulativeSuccess({\n      mathParams,\n      callback: setFromCache,\n    });\n  }, [ring, skill, tn, unskilled_assist, skilled_assist, compromised]);\n\n  return (\n    <StaticTextOutput\n      loading={loading}\n      result={result}\n      compromised={compromised}\n    />\n  );\n};\n\nconst StaticTextOutput = ({ result, loading, compromised }) => {\n  return (\n    <Paragraph>\n      <Text>\n        {compromised\n          ? `Chances to achieve TN, without taking strife, ignoring rerolls and other modifiers: `\n          : `Chances to achieve TN, taking as much strife as necessary, ignoring rerolls and other modifiers: `}\n      </Text>\n      <Text strong>{loading ? <LoadingOutlined /> : result}</Text>\n      <Text>{`.`}</Text>\n    </Paragraph>\n  );\n};\n\nconst Calculator = () => {\n  const [form] = Form.useForm();\n  const initialValues = {\n    ring: 3,\n    skill: 1,\n    tn: 3,\n    unskilled_assist: 0,\n    skilled_assist: 0,\n    compromised: false,\n  };\n  const [values, setValues] = useState(initialValues);\n\n  return (\n    <Form\n      layout={\"inline\"}\n      form={form}\n      initialValues={initialValues}\n      onValuesChange={(_, values) => {\n        setValues(values);\n      }}\n      className={styles.form}\n    >\n      <Form.Item label=\"Ring\" name=\"ring\">\n        <InputNumber min={1} max={10} />\n      </Form.Item>\n      <Form.Item label=\"Skill\" name=\"skill\">\n        <InputNumber min={0} max={10} />\n      </Form.Item>\n      <Form.Item label=\"TN\" name=\"tn\">\n        <InputNumber min={1} max={10} />\n      </Form.Item>\n      <Form.Item\n        label={\"Compromised?\"}\n        name=\"compromised\"\n        valuePropName=\"checked\"\n      >\n        <Switch />\n      </Form.Item>\n      <Divider />\n      <Form.Item label=\"Assistance (unskilled)\" name=\"unskilled_assist\">\n        <InputNumber min={0} max={10} />\n      </Form.Item>\n      <Form.Item label=\"Assistance (skilled)\" name=\"skilled_assist\">\n        <InputNumber min={0} max={10} />\n      </Form.Item>\n      <Divider />\n      <output>\n        <TextOutput {...values} />\n      </output>\n    </Form>\n  );\n};\n\nexport default Calculator;\n"],"sourceRoot":""}