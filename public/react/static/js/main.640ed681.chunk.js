(this.webpackJsonpsakkaku=this.webpackJsonpsakkaku||[]).push([[0],{153:function(e,t,n){e.exports={layout:"roller_layout__2TyHW"}},154:function(e,t,n){e.exports={submit:"Intent_submit__3pMAY"}},162:function(e,t,n){e.exports=n.p+"static/media/black.f14fed51.png"},163:function(e,t,n){e.exports=n.p+"static/media/blackot.3a5ad7bb.png"},164:function(e,t,n){e.exports=n.p+"static/media/blackst.3fad8195.png"},165:function(e,t,n){e.exports=n.p+"static/media/blacket.f0ca3076.png"},166:function(e,t,n){e.exports=n.p+"static/media/blacko.e44a1dd0.png"},167:function(e,t,n){e.exports=n.p+"static/media/blacks.216d4546.png"},168:function(e,t,n){e.exports=n.p+"static/media/white.c24c0c51.png"},169:function(e,t,n){e.exports=n.p+"static/media/whitee.7755ca79.png"},170:function(e,t,n){e.exports=n.p+"static/media/whiteet.d10cd0cc.png"},171:function(e,t,n){e.exports=n.p+"static/media/whiteo.1e81fee0.png"},172:function(e,t,n){e.exports=n.p+"static/media/whites.7cb9db03.png"},173:function(e,t,n){e.exports=n.p+"static/media/whiteso.f76a057b.png"},174:function(e,t,n){e.exports=n.p+"static/media/whitest.05051e66.png"},195:function(e,t,n){e.exports=n.p+"static/media/logo.20098cc4.png"},202:function(e,t,n){e.exports=n(363)},207:function(e,t,n){},208:function(e,t,n){},363:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(17),i=n.n(c),o=(n(207),n(57)),s=(n(208),n(41)),l=n(153),u=n.n(l),d=n(373),m=n(368),p=n(364),f=n(374),b=n(375),g=n(371),v=n(135),E=n(154),h=n.n(E),y=d.a.TextArea,k={labelCol:{span:8},wrapperCol:{span:16}},x={labelCol:{span:0},wrapperCol:{span:24}},O=[{required:!0,message:"Please fill this field"}],j=function(e){var t=e.completed,n=e.onFinish,a=e.values,c=e.loading;return r.a.createElement(m.a,Object.assign({},k,{initialValues:a,onFinish:function(e){n(Object(s.a)({},e,{modifiers:[e.modifier,e.compromised&&"compromised",e.void&&"void"].filter(Boolean)}))}}),r.a.createElement(m.a.Item,{label:"Campaign",name:"campaign",rules:O},r.a.createElement(d.a,{disabled:t})),r.a.createElement(m.a.Item,{label:"Character",name:"character",rules:O},r.a.createElement(d.a,{disabled:t})),r.a.createElement(m.a.Item,{label:"Description",name:"description",rules:O},r.a.createElement(y,{disabled:t})),r.a.createElement(p.a,null),r.a.createElement(m.a.Item,{label:"TN",name:"tn",rules:O},r.a.createElement(f.a,{disabled:t,min:1})),r.a.createElement(m.a.Item,{label:"Ring",name:"ring",rules:O},r.a.createElement(f.a,{disabled:t,min:1,max:5})),r.a.createElement(m.a.Item,{label:"Skill",name:"skill",rules:O},r.a.createElement(f.a,{disabled:t,min:0,max:5})),r.a.createElement(p.a,null),r.a.createElement(m.a.Item,{label:"Void?",name:"void",valuePropName:"checked"},r.a.createElement(b.a,{disabled:t})),r.a.createElement(m.a.Item,{label:"Advantage / Disadvantage",name:"modifier"},r.a.createElement(g.a.Group,{disabled:t},r.a.createElement(g.a.Button,{value:""},"None"),r.a.createElement(g.a.Button,{value:"distinction"},"Distinction"),r.a.createElement(g.a.Button,{value:"adversity"},"Adversity"))),r.a.createElement(m.a.Item,{label:"Compromised?",name:"compromised",valuePropName:"checked"},r.a.createElement(b.a,{disabled:t})),!t&&r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a,null),r.a.createElement(m.a.Item,x,r.a.createElement(v.a,{type:"primary",htmlType:"submit",className:h.a.submit,disabled:c},"Roll"))))},w=n(95),_=n(125),S=n(65),C=n.n(S),I=n(98),F=function(){var e=Object(I.a)(C.a.mark((function e(t){var n,a,r,c,i,o,s,l;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.uri,a=t.method,r=t.body,c=t.success,i=t.error,o={Accept:"application/json"},r&&(o["Content-Type"]="application/json"),e.prev=3,e.next=6,fetch("".concat("/api").concat(n),{method:a,headers:o,body:r?JSON.stringify(r):void 0});case 6:if((s=e.sent).ok){e.next=9;break}throw new Error("Bad status: ".concat(s.status));case 9:return e.next=11,s.json();case 11:l=e.sent,c(l),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),i?i(e.t0):console.error(e.t0);case 18:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(I.a)(C.a.mark((function e(t){var n,a,r,c;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.uri,a=t.body,r=t.success,c=t.error,e.abrupt("return",F({uri:n,method:"POST",body:a,success:r,error:c}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(I.a)(C.a.mark((function e(t){var n,a,r;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.uri,a=t.success,r=t.error,e.abrupt("return",F({uri:n,method:"GET",success:a,error:r}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(I.a)(C.a.mark((function e(t){var n,a,r,c,i,o;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.uri,a=t.body,r=t.success,c=t.error,e.prev=1,e.next=4,fetch("".concat("/api").concat(n),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-XSRF-TOKEN":decodeURIComponent(document.cookie.match("(^|;) ?XSRF-TOKEN=([^;]*)(;|$)")[2])},body:JSON.stringify(a)});case 4:if((i=e.sent).ok){e.next=7;break}throw new Error("Bad status: ".concat(i.status));case 7:return e.next=9,i.json();case 9:o=e.sent,r(o),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),c?c(e.t0):console.error(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),D=Object(_.b)({name:"roll",initialState:{campaign:"Test campaign",character:"Test character",description:"Test roll",tn:2,ring:2,skill:2,modifiers:[],dices:[],metadata:{},loading:!1},reducers:{softReset:function(e){e.dices=[],e.metadata={}},setParameters:function(e,t){var n=t.payload,a=n.campaign,r=n.character,c=n.description,i=n.tn,o=n.ring,s=n.skill,l=n.modifiers;e.campaign=a,e.character=r,e.character=c,e.tn=i,e.ring=o,e.skill=s,e.modifiers=l},updateDices:function(e,t){e.dices=t.payload},setMetadata:function(e,t){e.metadata=t.payload},setLoading:function(e,t){e.loading=t.payload},setId:function(e,t){e.id=t.id}}}),P=D.actions,B=P.setParameters,L=P.updateDices,q=P.setMetadata,Y=P.setLoading,A=P.setId,M=D.actions.softReset,X=function(e,t,n){return function(a){a(Y(!0));var r=e.tn,c=e.ring,i=e.skill,o=e.modifiers,s=e.dices;N({uri:"/public/ffg/l5r/rolls/reroll",body:{roll:{parameters:{tn:r,ring:c,skill:i,modifiers:o},dices:s},positions:t,modifier:n},success:function(e){a(L(e.dices)),a(q(e.metadata)),a(Y(!1))}})}},G=function(e,t){return function(n){n(Y(!0));var a=e.tn,r=e.ring,c=e.skill,i=e.modifiers,o=e.dices,s=e.metadata;N({uri:"/public/ffg/l5r/rolls/keep",body:{roll:{parameters:{tn:a,ring:r,skill:c,modifiers:i},dices:o,metadata:s},positions:t},success:function(e){n(L(e.dices)),n(Y(!1))}})}},H=function(e){return e.roll},J=D.reducer,W=n(366),K=n(69),U=n(74),Q=n(367),V=n(84),$=n.n(V),z=n(3),Z=n.n(z),ee=n(370),te=n(162),ne=n.n(te),ae=n(163),re=n.n(ae),ce=n(164),ie=n.n(ce),oe=n(165),se=n.n(oe),le=n(166),ue=n.n(le),de=n(167),me=n.n(de),pe=n(168),fe=n.n(pe),be=n(169),ge=n.n(be),ve=n(170),Ee=n.n(ve),he=n(171),ye=n.n(he),ke=n(172),xe=n.n(ke),Oe=n(173),je=n.n(Oe),we=n(174),_e=n.n(we),Se=function(e){var t=e.type,n=e.value,a=n.opportunity,r=n.strife,c=n.success,i=n.explosion;return"skill"===t?i?r?Ee.a:ge.a:c?a?je.a:r?_e.a:xe.a:a?ye.a:fe.a:r?i?se.a:c?ie.a:re.a:c?me.a:a?ue.a:ne.a},Ce=function(e){var t=e.dice,n=function(e){var t=e.value,n=t.opportunity,a=t.strife,r=t.success,c=t.explosion;return[n&&"Opportunity: ".concat(n),r&&"Success: ".concat(r),c&&"Explosion: ".concat(c),a&&"Strife: ".concat(a)].filter(Boolean).join("; ")||"Nothing"}(t);return r.a.createElement(ee.a,{src:Se(t),alt:n,title:n,preview:!1})},Ie=function(e){var t=e.dices;if(!(null===t||void 0===t?void 0:t.length))return null;var n=t.map((function(e,t){return{key:t.toString(),dice:e,selectable:e.selectable,selected:e.selected,toggle:e.toggle,disabled:e.disabled}}));return r.a.createElement(Q.b,{grid:{gutter:0,column:10},dataSource:n,renderItem:function(e){var t,n=e.key,a=e.dice,c=e.selectable,i=e.selected,o=e.toggle,s=e.disabled;return r.a.createElement(Q.b.Item,{key:n,className:Z()($.a.dice,(t={},Object(U.a)(t,$.a.selectable,c),Object(U.a)(t,$.a.selected,i),Object(U.a)(t,$.a.unselectable,s),Object(U.a)(t,$.a.rerolled,"rerolled"===a.status),t)),onClick:c?o:void 0},r.a.createElement(Ce,{dice:a}))}})},Fe=n(369),Ne=Fe.a.Paragraph,Te=function(e){var t=e.dices,n=e.text,a=e.footer;return r.a.createElement("div",null,r.a.createElement(Ne,null,n),r.a.createElement(Ie,{dices:t}),a)},Re=function(e){var t=e.dices,n=e.max,c=e.onFinish,i=e.compromised,l=e.trulyCompromised,u=e.loading,d=Object(a.useState)([]),m=Object(o.a)(d,2),p=m[0],f=m[1],b=n>p.length,g=l?"You cannot keep any dice due to being compromised.":"You can choose up to ".concat(n," dice").concat(n>1?"s":""," to keep (min 1).");return r.a.createElement(Te,{text:g,dices:t.map((function(e,t){var n=p.includes(t),a="pending"===e.status&&(!i||!e.value.strife),r=(n||b)&&a;return Object(s.a)({},e,{selectable:r,selected:n,disabled:!r,toggle:function(){return function(e){return p.includes(e)?f(p.filter((function(t){return t!==e}))):f([].concat(Object(K.a)(p),[e]))}(t)}})})),footer:(p.length>=1||l)&&r.a.createElement(v.a,{type:"primary",onClick:function(){return c(p)},disabled:u},"Continue")})},De=function(e){var t=e.dices,n=e.onFinish,c=e.compromised,i=e.loading,l=Object(a.useState)([]),u=Object(o.a)(l,2),d=u[0],m=u[1];return r.a.createElement(Te,{text:"Select which explosions you wish to keep (if any):",dices:t.map((function(e,t){var n="pending"===e.status&&(!c||!e.value.strife);return Object(s.a)({},e,{selectable:n,selected:"kept"===e.status||d.includes(t),disabled:!n&&"kept"!==e.status,toggle:function(){return function(e){return d.includes(e)?m(d.filter((function(t){return t!==e}))):m([].concat(Object(K.a)(d),[e]))}(t)}})})),footer:r.a.createElement(v.a,{type:"primary",onClick:function(){return n(d)},disabled:i},"Continue")})},Pe=function(e){var t=e.dices,n=e.trulyCompromised?"You couldn't keep any dice due to being compromised.":"You have kept:";return r.a.createElement(Te,{text:n,dices:t.map((function(e){var t="kept"===e.status;return Object(s.a)({},e,{disabled:!t,selected:t})}))})},Be=Fe.a.Text,Le=function(e){var t=e.dices,n=e.tn,a=[{type:"Successes",count:t.reduce((function(e,t){return e+(t.value.explosion||0)+(t.value.success||0)}),0),target:n},{type:"Strifes",count:t.reduce((function(e,t){return e+(t.value.strife||0)}),0)},{type:"Opportunities",count:t.reduce((function(e,t){return e+(t.value.opportunity||0)}),0)}];return r.a.createElement(Q.b,{grid:{gutter:16,column:3},dataSource:a,renderItem:function(e){var t=e.type,n=e.count,a=e.target;return r.a.createElement(Q.b.Item,null,r.a.createElement(Be,{strong:!0,type:a&&(n>=a?"success":"warning")},"".concat(t,": ").concat(n)),a&&r.a.createElement(Be,null," (required: ".concat(a,")")))}})},qe=function(e){var t=e.dices,n=e.onFinish,c=e.loading,i=Object(a.useState)([]),l=Object(o.a)(i,2),u=l[0],d=l[1];return r.a.createElement(Te,{text:"You can choose up to ".concat(2," dices to reroll."),dices:t.map((function(e,t){var n=u.includes(t),a=n||u.length<2;return Object(s.a)({},e,{selectable:a,selected:n,disabled:!a,toggle:function(){return function(e){return u.includes(e)?d(u.filter((function(t){return t!==e}))):d([].concat(Object(K.a)(u),[e]))}(t)}})})),footer:r.a.createElement(v.a,{type:"primary",onClick:function(){return n(u)},disabled:c},"Continue")})},Ye=function(e){var t=e.dices,n=e.onFinish,c=e.loading,i=Object(a.useState)([]),l=Object(o.a)(i,2),u=l[0],d=l[1],m=t.filter((function(e){var t=e.value;return t.success||t.explosion})),p=Math.min(2,m.length);return r.a.createElement(Te,{text:"You must reroll two success dices (if possible).",dices:t.map((function(e,t){var n=u.includes(t),a=(e.value.success||e.value.explosion)&&(n||u.length<2);return Object(s.a)({},e,{selectable:a,selected:n,disabled:!a,toggle:function(){return function(e){return u.includes(e)?d(u.filter((function(t){return t!==e}))):d([].concat(Object(K.a)(u),[e]))}(t)}})})),footer:u.length>=p&&r.a.createElement(v.a,{type:"primary",onClick:function(){return n(u)},disabled:c},"Continue")})},Ae=function(e){var t,n=e.user,a=Object(w.c)(H),c=Object(w.b)(),i=a.dices,o=a.tn,l=a.metadata,d=a.modifiers,m=a.ring,p=a.loading,f=i.length>0,b=f&&i.some((function(e){return"pending"===e.status})),g=i.filter((function(e){return"kept"===e.status})),E=g.length>0,h=(null===l||void 0===l||null===(t=l.rerolls)||void 0===t?void 0:t.length)||!(d.includes("adversity")||d.includes("distinction")),y=d.includes("compromised"),k=y&&f&&h&&!E&&i.filter((function(e){return"pending"===e.status})).every((function(e){return e.value.strife})),x=d.includes("void");return r.a.createElement("div",{className:u.a.layout},r.a.createElement(W.a,null,r.a.createElement(j,{completed:f,onFinish:function(e){return c(function(e,t){return function(n){n(Y(!0)),n(B(e));var a=e.tn,r=e.ring,c=e.skill,i=e.modifiers,o=e.campaign,s=e.character,l=e.description;t?R({uri:"/ffg/l5r/rolls/create",body:{tn:a,ring:r,skill:c,modifiers:i,campaign:o,character:s,description:l},success:function(e){n(L(e.dices)),n(A(e.id)),n(Y(!1))}}):N({uri:"/public/ffg/l5r/rolls/create",body:{tn:a,ring:r,skill:c,modifiers:i},success:function(e){n(L(e.dices)),n(Y(!1))}})}}(Object(s.a)({},a,{},e),n))},values:a,loading:p}),f&&r.a.createElement(r.a.Fragment,null,!h&&r.a.createElement(r.a.Fragment,null,d.includes("distinction")&&r.a.createElement(qe,{dices:i,onFinish:function(e){return c(X(a,e,"distinction"))},loading:p}),d.includes("adversity")&&r.a.createElement(Ye,{dices:i,onFinish:function(e){return c(X(a,e,"adversity"))},loading:p})),h&&r.a.createElement(r.a.Fragment,null,b?r.a.createElement(r.a.Fragment,null,!E&&r.a.createElement(Re,{dices:i,max:x?m+1:m,onFinish:function(e){return c(G(a,e))},compromised:y,trulyCompromised:k,loading:p}),E&&r.a.createElement(De,{dices:i,onFinish:function(e){return c(G(a,e))},compromised:y,loading:p})):r.a.createElement(r.a.Fragment,null,r.a.createElement(Pe,{dices:i,trulyCompromised:k}),r.a.createElement(Le,{dices:g,tn:o}),r.a.createElement(v.a,{type:"primary",onClick:function(){return c(M())}},"Reroll"))))))},Me=n(365),Xe=n(372),Ge=n(195),He=n.n(Ge),Je=n(99),We=n.n(Je),Ke=Me.a.Header,Ue=Me.a.Content,Qe=Me.a.Footer,Ve=function(e){var t=e.user,n=e.children;return r.a.createElement(Me.a,{className:We.a.layout},r.a.createElement(Ke,null,r.a.createElement(Xe.a,{theme:"dark",mode:"horizontal"},r.a.createElement(Xe.a.Item,{className:We.a.logo},r.a.createElement("a",{href:"/"},r.a.createElement("img",{alt:"Logo",src:He.a}))),r.a.createElement(Xe.a.Item,null,r.a.createElement("a",{href:"/"},"Roll")),r.a.createElement(Xe.a.Item,{className:We.a.login},t?r.a.createElement("a",{href:"/user/profile"},t.name):r.a.createElement("a",{href:"/login"},"Login")))),r.a.createElement(Ue,null,n),r.a.createElement(Qe,{className:We.a.footer},"Sakkaku Project / 2020 / ",r.a.createElement("a",{href:"mailto:contact.sakkaku@gmail.com"},"Issue? Suggestion?")))},$e=function(){var e=Object(a.useState)(),t=Object(o.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){T({uri:"/user",success:function(e){c(e)},error:function(e){}})}),[]),r.a.createElement(Ve,{user:n},r.a.createElement(Ae,{user:n}))},ze=Object(_.a)({reducer:{roll:J}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(w.a,{store:ze},r.a.createElement($e,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},84:function(e,t,n){e.exports={dice:"Dices_dice__cqowQ",selectable:"Dices_selectable__2UH3q",selected:"Dices_selected__1Gb1I",unselectable:"Dices_unselectable__KQSGp",rerolled:"Dices_rerolled__2e0qS"}},99:function(e,t,n){e.exports={layout:"Layout_layout__UFIxE",logo:"Layout_logo__1Oa8g",footer:"Layout_footer__1d2pN",login:"Layout_login__2luPa"}}},[[202,1,2]]]);
//# sourceMappingURL=main.640ed681.chunk.js.map