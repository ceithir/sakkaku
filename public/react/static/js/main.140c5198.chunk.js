(this.webpackJsonpsakkaku=this.webpackJsonpsakkaku||[]).push([[0],{153:function(e,t,n){e.exports={layout:"roller_layout__2TyHW"}},154:function(e,t,n){e.exports={submit:"Intent_submit__3pMAY"}},162:function(e,t,n){e.exports=n.p+"static/media/black.f14fed51.png"},163:function(e,t,n){e.exports=n.p+"static/media/blackot.3a5ad7bb.png"},164:function(e,t,n){e.exports=n.p+"static/media/blackst.3fad8195.png"},165:function(e,t,n){e.exports=n.p+"static/media/blacket.f0ca3076.png"},166:function(e,t,n){e.exports=n.p+"static/media/blacko.e44a1dd0.png"},167:function(e,t,n){e.exports=n.p+"static/media/blacks.216d4546.png"},168:function(e,t,n){e.exports=n.p+"static/media/white.c24c0c51.png"},169:function(e,t,n){e.exports=n.p+"static/media/whitee.7755ca79.png"},170:function(e,t,n){e.exports=n.p+"static/media/whiteet.d10cd0cc.png"},171:function(e,t,n){e.exports=n.p+"static/media/whiteo.1e81fee0.png"},172:function(e,t,n){e.exports=n.p+"static/media/whites.7cb9db03.png"},173:function(e,t,n){e.exports=n.p+"static/media/whiteso.f76a057b.png"},174:function(e,t,n){e.exports=n.p+"static/media/whitest.05051e66.png"},195:function(e,t,n){e.exports=n.p+"static/media/logo.20098cc4.png"},202:function(e,t,n){e.exports=n(363)},207:function(e,t,n){},208:function(e,t,n){},363:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(17),c=n.n(i),o=(n(207),n(57)),s=(n(208),n(40)),l=n(153),u=n.n(l),d=n(367),m=n(372),p=n(373),f=n(370),b=n(374),g=n(135),v=n(154),E=n.n(v),h={labelCol:{span:6},wrapperCol:{span:18}},y={labelCol:{span:0},wrapperCol:{span:24}},k=function(e){var t=e.completed,n=e.onFinish,a=e.values,i=e.loading;return r.a.createElement(d.a,Object.assign({},h,{initialValues:a,onFinish:function(e){n(Object(s.a)({},e,{modifiers:[e.modifier,e.compromised&&"compromised"].filter(Boolean)}))}}),r.a.createElement(d.a.Item,{label:"Description",name:"description",rules:[{required:!0,message:"Roll description is required"}]},r.a.createElement(m.a,{disabled:t})),r.a.createElement(d.a.Item,{label:"TN",name:"tn",rules:[{required:!0}]},r.a.createElement(p.a,{disabled:t,min:1})),r.a.createElement(d.a.Item,{label:"Ring",name:"ring",rules:[{required:!0}]},r.a.createElement(p.a,{disabled:t,min:1,max:5})),r.a.createElement(d.a.Item,{label:"Skill",name:"skill",rules:[{required:!0}]},r.a.createElement(p.a,{disabled:t,min:0,max:5})),r.a.createElement(d.a.Item,{label:"Modifier",name:"modifier"},r.a.createElement(f.a.Group,{disabled:t},r.a.createElement(f.a.Button,{value:"none"},"None"),r.a.createElement(f.a.Button,{value:"distinction"},"Distinction"),r.a.createElement(f.a.Button,{value:"adversity"},"Adversity"))),r.a.createElement(d.a.Item,{label:"Compromised?",name:"compromised",valuePropName:"checked"},r.a.createElement(b.a,{disabled:t})),!t&&r.a.createElement(d.a.Item,y,r.a.createElement(g.a,{type:"primary",htmlType:"submit",className:E.a.submit,disabled:i},"Roll")))},x=n(95),j=n(124),O=n(75),_=n.n(O),w=n(125),S=function(){var e=Object(w.a)(_.a.mark((function e(t){var n,a,r,i,c,o,s,l;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.uri,a=t.method,r=t.body,i=t.success,c=t.error,o={Accept:"application/json"},r&&(o["Content-Type"]="application/json"),e.prev=3,e.next=6,fetch("".concat("/api").concat(n),{method:a,headers:o,body:r?JSON.stringify(r):void 0});case 6:if((s=e.sent).ok){e.next=9;break}throw new Error("Bad status: ".concat(s.status));case 9:return e.next=11,s.json();case 11:l=e.sent,i(l),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),c?c(e.t0):console.error(e.t0);case 18:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(w.a)(_.a.mark((function e(t){var n,a,r,i;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.uri,a=t.body,r=t.success,i=t.error,e.abrupt("return",S({uri:n,method:"POST",body:a,success:r,error:i}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(w.a)(_.a.mark((function e(t){var n,a,r;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.uri,a=t.success,r=t.error,e.abrupt("return",S({uri:n,method:"GET",success:a,error:r}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=Object(j.b)({name:"roll",initialState:{description:"Example",tn:2,ring:2,skill:2,modifiers:[],dices:[],metadata:{},loading:!1},reducers:{softReset:function(e){e.dices=[],e.metadata={}},setParameters:function(e,t){var n=t.payload,a=n.description,r=n.tn,i=n.ring,c=n.skill,o=n.modifiers,s=n.compromised;e.description=a,e.tn=r,e.ring=i,e.skill=c,e.modifiers=o,e.compromised=s},updateDices:function(e,t){e.dices=t.payload},setMetadata:function(e,t){e.metadata=t.payload},setLoading:function(e,t){e.loading=t.payload}}}),N=F.actions,q=N.setParameters,D=N.updateDices,B=N.setMetadata,L=N.setLoading,P=F.actions.softReset,R=function(e,t,n){return function(a){a(L(!0));var r=e.tn,i=e.ring,c=e.skill,o=e.modifiers,s=e.dices;C({uri:"/public/ffg/l5r/rolls/reroll",body:{roll:{parameters:{tn:r,ring:i,skill:c,modifiers:o},dices:s},positions:t,modifier:n},success:function(e){a(D(e.dices)),a(B(e.metadata)),a(L(!1))}})}},T=function(e,t){return function(n){n(L(!0));var a=e.tn,r=e.ring,i=e.skill,c=e.modifiers,o=e.dices,s=e.metadata;C({uri:"/public/ffg/l5r/rolls/keep",body:{roll:{parameters:{tn:a,ring:r,skill:i,modifiers:c},dices:o,metadata:s},positions:t},success:function(e){n(D(e.dices)),n(L(!1))}})}},Y=function(e){return e.roll},M=F.reducer,G=n(365),A=n(68),H=n(73),J=n(366),W=n(84),Q=n.n(W),U=n(3),z=n.n(U),K=n(369),V=n(162),$=n.n(V),X=n(163),Z=n.n(X),ee=n(164),te=n.n(ee),ne=n(165),ae=n.n(ne),re=n(166),ie=n.n(re),ce=n(167),oe=n.n(ce),se=n(168),le=n.n(se),ue=n(169),de=n.n(ue),me=n(170),pe=n.n(me),fe=n(171),be=n.n(fe),ge=n(172),ve=n.n(ge),Ee=n(173),he=n.n(Ee),ye=n(174),ke=n.n(ye),xe=function(e){var t=e.type,n=e.value,a=n.opportunity,r=n.strife,i=n.success,c=n.explosion;return"skill"===t?c?r?pe.a:de.a:i?a?he.a:r?ke.a:ve.a:a?be.a:le.a:r?c?ae.a:i?te.a:Z.a:i?oe.a:a?ie.a:$.a},je=function(e){var t=e.dice,n=function(e){var t=e.value,n=t.opportunity,a=t.strife,r=t.success,i=t.explosion;return[n&&"Opportunity: ".concat(n),r&&"Success: ".concat(r),i&&"Explosion: ".concat(i),a&&"Strife: ".concat(a)].filter(Boolean).join("; ")||"Nothing"}(t);return r.a.createElement(K.a,{src:xe(t),alt:n,title:n,preview:!1})},Oe=function(e){var t=e.dices;if(!(null===t||void 0===t?void 0:t.length))return null;var n=t.map((function(e,t){return{key:t.toString(),dice:e,selectable:e.selectable,selected:e.selected,toggle:e.toggle,disabled:e.disabled}}));return r.a.createElement(J.b,{grid:{gutter:0,column:10},dataSource:n,renderItem:function(e){var t,n=e.key,a=e.dice,i=e.selectable,c=e.selected,o=e.toggle,s=e.disabled;return r.a.createElement(J.b.Item,{key:n,className:z()(Q.a.dice,(t={},Object(H.a)(t,Q.a.selectable,i),Object(H.a)(t,Q.a.selected,c),Object(H.a)(t,Q.a.unselectable,s),Object(H.a)(t,Q.a.rerolled,"rerolled"===a.status),t)),onClick:i?o:void 0},r.a.createElement(je,{dice:a}))}})},_e=n(368),we=_e.a.Paragraph,Se=function(e){var t=e.dices,n=e.text,a=e.footer;return r.a.createElement("div",null,r.a.createElement(we,null,n),r.a.createElement(Oe,{dices:t}),a)},Ce=function(e){var t=e.dices,n=e.max,i=e.onFinish,c=e.compromised,l=e.trulyCompromised,u=e.loading,d=Object(a.useState)([]),m=Object(o.a)(d,2),p=m[0],f=m[1],b=n>p.length,v=l?"You cannot keep any dice due to being compromised.":"You can choose up to ".concat(n," dice").concat(n>1?"s":""," to keep (min 1).");return r.a.createElement(Se,{text:v,dices:t.map((function(e,t){var n=p.includes(t),a="pending"===e.status&&(!c||!e.value.strife),r=(n||b)&&a;return Object(s.a)({},e,{selectable:r,selected:n,disabled:!r,toggle:function(){return function(e){return p.includes(e)?f(p.filter((function(t){return t!==e}))):f([].concat(Object(A.a)(p),[e]))}(t)}})})),footer:(p.length>=1||l)&&r.a.createElement(g.a,{type:"primary",onClick:function(){return i(p)},disabled:u},"Continue")})},Ie=function(e){var t=e.dices,n=e.onFinish,i=e.compromised,c=e.loading,l=Object(a.useState)([]),u=Object(o.a)(l,2),d=u[0],m=u[1];return r.a.createElement(Se,{text:"Select which explosions you wish to keep (if any):",dices:t.map((function(e,t){var n="pending"===e.status&&(!i||!e.value.strife);return Object(s.a)({},e,{selectable:n,selected:"kept"===e.status||d.includes(t),disabled:!n&&"kept"!==e.status,toggle:function(){return function(e){return d.includes(e)?m(d.filter((function(t){return t!==e}))):m([].concat(Object(A.a)(d),[e]))}(t)}})})),footer:r.a.createElement(g.a,{type:"primary",onClick:function(){return n(d)},disabled:c},"Continue")})},Fe=function(e){var t=e.dices,n=e.trulyCompromised?"You couldn't keep any dice due to being compromised.":"You have kept:";return r.a.createElement(Se,{text:n,dices:t.map((function(e){var t="kept"===e.status;return Object(s.a)({},e,{disabled:!t,selected:t})}))})},Ne=_e.a.Text,qe=function(e){var t=e.dices,n=e.tn,a=[{type:"Successes",count:t.reduce((function(e,t){return e+(t.value.explosion||0)+(t.value.success||0)}),0),target:n},{type:"Strifes",count:t.reduce((function(e,t){return e+(t.value.strife||0)}),0)},{type:"Opportunities",count:t.reduce((function(e,t){return e+(t.value.opportunity||0)}),0)}];return r.a.createElement(J.b,{grid:{gutter:16,column:3},dataSource:a,renderItem:function(e){var t=e.type,n=e.count,a=e.target;return r.a.createElement(J.b.Item,null,r.a.createElement(Ne,{strong:!0,type:a&&(n>=a?"success":"warning")},"".concat(t,": ").concat(n)),a&&r.a.createElement(Ne,null," (required: ".concat(a,")")))}})},De=function(e){var t=e.dices,n=e.onFinish,i=e.loading,c=Object(a.useState)([]),l=Object(o.a)(c,2),u=l[0],d=l[1];return r.a.createElement(Se,{text:"You can choose up to ".concat(2," dices to reroll."),dices:t.map((function(e,t){var n=u.includes(t),a=n||u.length<2;return Object(s.a)({},e,{selectable:a,selected:n,disabled:!a,toggle:function(){return function(e){return u.includes(e)?d(u.filter((function(t){return t!==e}))):d([].concat(Object(A.a)(u),[e]))}(t)}})})),footer:r.a.createElement(g.a,{type:"primary",onClick:function(){return n(u)},disabled:i},"Continue")})},Be=function(e){var t=e.dices,n=e.onFinish,i=e.loading,c=Object(a.useState)([]),l=Object(o.a)(c,2),u=l[0],d=l[1],m=t.filter((function(e){var t=e.value;return t.success||t.explosion})),p=Math.min(2,m.length);return r.a.createElement(Se,{text:"You must reroll two success dices (if possible).",dices:t.map((function(e,t){var n=u.includes(t),a=(e.value.success||e.value.explosion)&&(n||u.length<2);return Object(s.a)({},e,{selectable:a,selected:n,disabled:!a,toggle:function(){return function(e){return u.includes(e)?d(u.filter((function(t){return t!==e}))):d([].concat(Object(A.a)(u),[e]))}(t)}})})),footer:u.length>=p&&r.a.createElement(g.a,{type:"primary",onClick:function(){return n(u)},disabled:i},"Continue")})},Le=function(){var e,t=Object(x.c)(Y),n=Object(x.b)(),a=t.dices,i=t.tn,c=t.metadata,o=t.modifiers,l=t.ring,d=t.compromised,m=t.loading,p=a.length>0,f=p&&a.some((function(e){return"pending"===e.status})),b=a.filter((function(e){return"kept"===e.status})),v=b.length>0,E=(null===c||void 0===c||null===(e=c.rerolls)||void 0===e?void 0:e.length)||!(o.includes("adversity")||o.includes("distinction")),h=d&&p&&E&&!v&&a.filter((function(e){return"pending"===e.status})).every((function(e){return e.value.strife}));return r.a.createElement("div",{className:u.a.layout},r.a.createElement(G.a,null,r.a.createElement(k,{completed:p,onFinish:function(e){return n((a=Object(s.a)({},t,{},e),function(e){e(L(!0)),e(q(a));var t=a.tn,n=a.ring,r=a.skill,i=a.modifiers;C({uri:"/public/ffg/l5r/rolls/create",body:{tn:t,ring:n,skill:r,modifiers:i},success:function(t){e(D(t.dices)),e(L(!1))}})}));var a},values:t,loading:m}),p&&r.a.createElement(r.a.Fragment,null,!E&&r.a.createElement(r.a.Fragment,null,o.includes("distinction")&&r.a.createElement(De,{dices:a,onFinish:function(e){return n(R(t,e,"distinction"))},loading:m}),o.includes("adversity")&&r.a.createElement(Be,{dices:a,onFinish:function(e){return n(R(t,e,"adversity"))},loading:m})),E&&r.a.createElement(r.a.Fragment,null,f?r.a.createElement(r.a.Fragment,null,!v&&r.a.createElement(Ce,{dices:a,max:l,onFinish:function(e){return n(T(t,e))},compromised:d,trulyCompromised:h,loading:m}),v&&r.a.createElement(Ie,{dices:a,onFinish:function(e){return n(T(t,e))},compromised:d,loading:m})):r.a.createElement(r.a.Fragment,null,r.a.createElement(Fe,{dices:a,trulyCompromised:h}),r.a.createElement(qe,{dices:b,tn:i}),r.a.createElement(g.a,{type:"primary",onClick:function(){return n(P())}},"Reroll"))))))},Pe=n(364),Re=n(371),Te=n(195),Ye=n.n(Te),Me=n(98),Ge=n.n(Me),Ae=Pe.a.Header,He=Pe.a.Content,Je=Pe.a.Footer,We=function(e){var t=e.user,n=e.children;return r.a.createElement(Pe.a,{className:Ge.a.layout},r.a.createElement(Ae,null,r.a.createElement(Re.a,{theme:"dark",mode:"horizontal"},r.a.createElement(Re.a.Item,{className:Ge.a.logo},r.a.createElement("a",{href:"/"},r.a.createElement("img",{alt:"Logo",src:Ye.a}))),r.a.createElement(Re.a.Item,null,r.a.createElement("a",{href:"/"},"Roll")),r.a.createElement(Re.a.Item,{className:Ge.a.login},t?r.a.createElement("a",{href:"/user/profile"},t.name):r.a.createElement("a",{href:"/login"},"Login")))),r.a.createElement(He,null,n),r.a.createElement(Je,{className:Ge.a.footer},"Sakkaku Project / 2020 / ",r.a.createElement("a",{href:"mailto:contact.sakkaku@gmail.com"},"Issue? Suggestion?")))},Qe=function(){var e=Object(a.useState)(),t=Object(o.a)(e,2),n=t[0],i=t[1];return Object(a.useEffect)((function(){I({uri:"/user",success:function(e){i(e)},error:function(e){}})}),[]),r.a.createElement(We,{user:n},r.a.createElement(Le,null))},Ue=Object(j.a)({reducer:{roll:M}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(x.a,{store:Ue},r.a.createElement(Qe,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},84:function(e,t,n){e.exports={dice:"Dices_dice__cqowQ",selectable:"Dices_selectable__2UH3q",selected:"Dices_selected__1Gb1I",unselectable:"Dices_unselectable__KQSGp",rerolled:"Dices_rerolled__2e0qS"}},98:function(e,t,n){e.exports={layout:"Layout_layout__UFIxE",logo:"Layout_logo__1Oa8g",footer:"Layout_footer__1d2pN",login:"Layout_login__2luPa"}}},[[202,1,2]]]);
//# sourceMappingURL=main.140c5198.chunk.js.map