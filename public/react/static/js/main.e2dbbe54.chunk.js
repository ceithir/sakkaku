(this.webpackJsonpsakkaku=this.webpackJsonpsakkaku||[]).push([[0],{153:function(e,t,a){e.exports={layout:"roller_layout__2TyHW"}},154:function(e,t,a){e.exports={submit:"Intent_submit__3pMAY"}},162:function(e,t,a){e.exports=a.p+"static/media/black.f14fed51.png"},163:function(e,t,a){e.exports=a.p+"static/media/blackot.3a5ad7bb.png"},164:function(e,t,a){e.exports=a.p+"static/media/blackst.3fad8195.png"},165:function(e,t,a){e.exports=a.p+"static/media/blacket.f0ca3076.png"},166:function(e,t,a){e.exports=a.p+"static/media/blacko.e44a1dd0.png"},167:function(e,t,a){e.exports=a.p+"static/media/blacks.216d4546.png"},168:function(e,t,a){e.exports=a.p+"static/media/white.c24c0c51.png"},169:function(e,t,a){e.exports=a.p+"static/media/whitee.7755ca79.png"},170:function(e,t,a){e.exports=a.p+"static/media/whiteet.d10cd0cc.png"},171:function(e,t,a){e.exports=a.p+"static/media/whiteo.1e81fee0.png"},172:function(e,t,a){e.exports=a.p+"static/media/whites.7cb9db03.png"},173:function(e,t,a){e.exports=a.p+"static/media/whiteso.f76a057b.png"},174:function(e,t,a){e.exports=a.p+"static/media/whitest.05051e66.png"},195:function(e,t,a){e.exports=a.p+"static/media/logo.20098cc4.png"},202:function(e,t,a){e.exports=a(363)},207:function(e,t,a){},208:function(e,t,a){},363:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(17),i=a.n(c),o=(a(207),a(57)),l=(a(208),a(41)),s=a(153),u=a.n(s),d=a(373),m=a(368),p=a(364),f=a(374),b=a(375),g=a(371),E=a(135),v=a(154),h=a.n(v),y=d.a.TextArea,k={labelCol:{span:8},wrapperCol:{span:16}},x={labelCol:{span:0},wrapperCol:{span:24}},j=[{required:!0,message:"Please fill this field"}],O=function(e){var t=e.completed,a=e.onFinish,n=e.values,c=e.loading;return r.a.createElement(m.a,Object.assign({},k,{initialValues:n,onFinish:function(e){a(Object(l.a)({},e,{modifiers:[e.modifier,e.compromised&&"compromised",e.void&&"void"].filter(Boolean)}))}}),r.a.createElement(m.a.Item,{label:"Campaign",name:"campaign",rules:j},r.a.createElement(d.a,{disabled:t})),r.a.createElement(m.a.Item,{label:"Character",name:"character",rules:j},r.a.createElement(d.a,{disabled:t})),r.a.createElement(m.a.Item,{label:"Description",name:"description",rules:j},r.a.createElement(y,{disabled:t})),r.a.createElement(p.a,null),r.a.createElement(m.a.Item,{label:"TN",name:"tn",rules:j},r.a.createElement(f.a,{disabled:t,min:1})),r.a.createElement(m.a.Item,{label:"Ring",name:"ring",rules:j},r.a.createElement(f.a,{disabled:t,min:1,max:5})),r.a.createElement(m.a.Item,{label:"Skill",name:"skill",rules:j},r.a.createElement(f.a,{disabled:t,min:0,max:5})),r.a.createElement(p.a,null),r.a.createElement(m.a.Item,{label:"Void?",name:"void",valuePropName:"checked"},r.a.createElement(b.a,{disabled:t})),r.a.createElement(m.a.Item,{label:"Advantage / Disadvantage",name:"modifier"},r.a.createElement(g.a.Group,{disabled:t},r.a.createElement(g.a.Button,{value:""},"None"),r.a.createElement(g.a.Button,{value:"distinction"},"Distinction"),r.a.createElement(g.a.Button,{value:"adversity"},"Adversity"))),r.a.createElement(m.a.Item,{label:"Compromised?",name:"compromised",valuePropName:"checked"},r.a.createElement(b.a,{disabled:t})),!t&&r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a,null),r.a.createElement(m.a.Item,x,r.a.createElement(E.a,{type:"primary",htmlType:"submit",className:h.a.submit,disabled:c},"Roll"))))},_=a(95),w=a(124),C=a(75),I=a.n(C),S=a(125),F=function(){var e=Object(S.a)(I.a.mark((function e(t){var a,n,r,c,i,o,l,s;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.uri,n=t.method,r=t.body,c=t.success,i=t.error,o={Accept:"application/json"},r&&(o["Content-Type"]="application/json"),e.prev=3,e.next=6,fetch("".concat("/api").concat(a),{method:n,headers:o,body:r?JSON.stringify(r):void 0});case 6:if((l=e.sent).ok){e.next=9;break}throw new Error("Bad status: ".concat(l.status));case 9:return e.next=11,l.json();case 11:s=e.sent,c(s),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),i?i(e.t0):console.error(e.t0);case 18:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(S.a)(I.a.mark((function e(t){var a,n,r,c;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.uri,n=t.body,r=t.success,c=t.error,e.abrupt("return",F({uri:a,method:"POST",body:n,success:r,error:c}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(S.a)(I.a.mark((function e(t){var a,n,r;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.uri,n=t.success,r=t.error,e.abrupt("return",F({uri:a,method:"GET",success:n,error:r}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=Object(w.b)({name:"roll",initialState:{campaign:"Test campaign",character:"Test character",description:"Test roll",tn:2,ring:2,skill:2,modifiers:[],dices:[],metadata:{},loading:!1},reducers:{softReset:function(e){e.dices=[],e.metadata={}},setParameters:function(e,t){var a=t.payload,n=a.campaign,r=a.character,c=a.description,i=a.tn,o=a.ring,l=a.skill,s=a.modifiers;e.campaign=n,e.character=r,e.character=c,e.tn=i,e.ring=o,e.skill=l,e.modifiers=s},updateDices:function(e,t){e.dices=t.payload},setMetadata:function(e,t){e.metadata=t.payload},setLoading:function(e,t){e.loading=t.payload}}}),P=D.actions,B=P.setParameters,L=P.updateDices,Y=P.setMetadata,R=P.setLoading,q=D.actions.softReset,A=function(e,t,a){return function(n){n(R(!0));var r=e.tn,c=e.ring,i=e.skill,o=e.modifiers,l=e.dices;N({uri:"/public/ffg/l5r/rolls/reroll",body:{roll:{parameters:{tn:r,ring:c,skill:i,modifiers:o},dices:l},positions:t,modifier:a},success:function(e){n(L(e.dices)),n(Y(e.metadata)),n(R(!1))}})}},M=function(e,t){return function(a){a(R(!0));var n=e.tn,r=e.ring,c=e.skill,i=e.modifiers,o=e.dices,l=e.metadata;N({uri:"/public/ffg/l5r/rolls/keep",body:{roll:{parameters:{tn:n,ring:r,skill:c,modifiers:i},dices:o,metadata:l},positions:t},success:function(e){a(L(e.dices)),a(R(!1))}})}},G=function(e){return e.roll},H=D.reducer,J=a(366),W=a(68),Q=a(73),U=a(367),V=a(84),z=a.n(V),K=a(3),$=a.n(K),X=a(370),Z=a(162),ee=a.n(Z),te=a(163),ae=a.n(te),ne=a(164),re=a.n(ne),ce=a(165),ie=a.n(ce),oe=a(166),le=a.n(oe),se=a(167),ue=a.n(se),de=a(168),me=a.n(de),pe=a(169),fe=a.n(pe),be=a(170),ge=a.n(be),Ee=a(171),ve=a.n(Ee),he=a(172),ye=a.n(he),ke=a(173),xe=a.n(ke),je=a(174),Oe=a.n(je),_e=function(e){var t=e.type,a=e.value,n=a.opportunity,r=a.strife,c=a.success,i=a.explosion;return"skill"===t?i?r?ge.a:fe.a:c?n?xe.a:r?Oe.a:ye.a:n?ve.a:me.a:r?i?ie.a:c?re.a:ae.a:c?ue.a:n?le.a:ee.a},we=function(e){var t=e.dice,a=function(e){var t=e.value,a=t.opportunity,n=t.strife,r=t.success,c=t.explosion;return[a&&"Opportunity: ".concat(a),r&&"Success: ".concat(r),c&&"Explosion: ".concat(c),n&&"Strife: ".concat(n)].filter(Boolean).join("; ")||"Nothing"}(t);return r.a.createElement(X.a,{src:_e(t),alt:a,title:a,preview:!1})},Ce=function(e){var t=e.dices;if(!(null===t||void 0===t?void 0:t.length))return null;var a=t.map((function(e,t){return{key:t.toString(),dice:e,selectable:e.selectable,selected:e.selected,toggle:e.toggle,disabled:e.disabled}}));return r.a.createElement(U.b,{grid:{gutter:0,column:10},dataSource:a,renderItem:function(e){var t,a=e.key,n=e.dice,c=e.selectable,i=e.selected,o=e.toggle,l=e.disabled;return r.a.createElement(U.b.Item,{key:a,className:$()(z.a.dice,(t={},Object(Q.a)(t,z.a.selectable,c),Object(Q.a)(t,z.a.selected,i),Object(Q.a)(t,z.a.unselectable,l),Object(Q.a)(t,z.a.rerolled,"rerolled"===n.status),t)),onClick:c?o:void 0},r.a.createElement(we,{dice:n}))}})},Ie=a(369),Se=Ie.a.Paragraph,Fe=function(e){var t=e.dices,a=e.text,n=e.footer;return r.a.createElement("div",null,r.a.createElement(Se,null,a),r.a.createElement(Ce,{dices:t}),n)},Ne=function(e){var t=e.dices,a=e.max,c=e.onFinish,i=e.compromised,s=e.trulyCompromised,u=e.loading,d=Object(n.useState)([]),m=Object(o.a)(d,2),p=m[0],f=m[1],b=a>p.length,g=s?"You cannot keep any dice due to being compromised.":"You can choose up to ".concat(a," dice").concat(a>1?"s":""," to keep (min 1).");return r.a.createElement(Fe,{text:g,dices:t.map((function(e,t){var a=p.includes(t),n="pending"===e.status&&(!i||!e.value.strife),r=(a||b)&&n;return Object(l.a)({},e,{selectable:r,selected:a,disabled:!r,toggle:function(){return function(e){return p.includes(e)?f(p.filter((function(t){return t!==e}))):f([].concat(Object(W.a)(p),[e]))}(t)}})})),footer:(p.length>=1||s)&&r.a.createElement(E.a,{type:"primary",onClick:function(){return c(p)},disabled:u},"Continue")})},Te=function(e){var t=e.dices,a=e.onFinish,c=e.compromised,i=e.loading,s=Object(n.useState)([]),u=Object(o.a)(s,2),d=u[0],m=u[1];return r.a.createElement(Fe,{text:"Select which explosions you wish to keep (if any):",dices:t.map((function(e,t){var a="pending"===e.status&&(!c||!e.value.strife);return Object(l.a)({},e,{selectable:a,selected:"kept"===e.status||d.includes(t),disabled:!a&&"kept"!==e.status,toggle:function(){return function(e){return d.includes(e)?m(d.filter((function(t){return t!==e}))):m([].concat(Object(W.a)(d),[e]))}(t)}})})),footer:r.a.createElement(E.a,{type:"primary",onClick:function(){return a(d)},disabled:i},"Continue")})},De=function(e){var t=e.dices,a=e.trulyCompromised?"You couldn't keep any dice due to being compromised.":"You have kept:";return r.a.createElement(Fe,{text:a,dices:t.map((function(e){var t="kept"===e.status;return Object(l.a)({},e,{disabled:!t,selected:t})}))})},Pe=Ie.a.Text,Be=function(e){var t=e.dices,a=e.tn,n=[{type:"Successes",count:t.reduce((function(e,t){return e+(t.value.explosion||0)+(t.value.success||0)}),0),target:a},{type:"Strifes",count:t.reduce((function(e,t){return e+(t.value.strife||0)}),0)},{type:"Opportunities",count:t.reduce((function(e,t){return e+(t.value.opportunity||0)}),0)}];return r.a.createElement(U.b,{grid:{gutter:16,column:3},dataSource:n,renderItem:function(e){var t=e.type,a=e.count,n=e.target;return r.a.createElement(U.b.Item,null,r.a.createElement(Pe,{strong:!0,type:n&&(a>=n?"success":"warning")},"".concat(t,": ").concat(a)),n&&r.a.createElement(Pe,null," (required: ".concat(n,")")))}})},Le=function(e){var t=e.dices,a=e.onFinish,c=e.loading,i=Object(n.useState)([]),s=Object(o.a)(i,2),u=s[0],d=s[1];return r.a.createElement(Fe,{text:"You can choose up to ".concat(2," dices to reroll."),dices:t.map((function(e,t){var a=u.includes(t),n=a||u.length<2;return Object(l.a)({},e,{selectable:n,selected:a,disabled:!n,toggle:function(){return function(e){return u.includes(e)?d(u.filter((function(t){return t!==e}))):d([].concat(Object(W.a)(u),[e]))}(t)}})})),footer:r.a.createElement(E.a,{type:"primary",onClick:function(){return a(u)},disabled:c},"Continue")})},Ye=function(e){var t=e.dices,a=e.onFinish,c=e.loading,i=Object(n.useState)([]),s=Object(o.a)(i,2),u=s[0],d=s[1],m=t.filter((function(e){var t=e.value;return t.success||t.explosion})),p=Math.min(2,m.length);return r.a.createElement(Fe,{text:"You must reroll two success dices (if possible).",dices:t.map((function(e,t){var a=u.includes(t),n=(e.value.success||e.value.explosion)&&(a||u.length<2);return Object(l.a)({},e,{selectable:n,selected:a,disabled:!n,toggle:function(){return function(e){return u.includes(e)?d(u.filter((function(t){return t!==e}))):d([].concat(Object(W.a)(u),[e]))}(t)}})})),footer:u.length>=p&&r.a.createElement(E.a,{type:"primary",onClick:function(){return a(u)},disabled:c},"Continue")})},Re=function(){var e,t=Object(_.c)(G),a=Object(_.b)(),n=t.dices,c=t.tn,i=t.metadata,o=t.modifiers,s=t.ring,d=t.loading,m=n.length>0,p=m&&n.some((function(e){return"pending"===e.status})),f=n.filter((function(e){return"kept"===e.status})),b=f.length>0,g=(null===i||void 0===i||null===(e=i.rerolls)||void 0===e?void 0:e.length)||!(o.includes("adversity")||o.includes("distinction")),v=o.includes("compromised"),h=v&&m&&g&&!b&&n.filter((function(e){return"pending"===e.status})).every((function(e){return e.value.strife})),y=o.includes("void");return r.a.createElement("div",{className:u.a.layout},r.a.createElement(J.a,null,r.a.createElement(O,{completed:m,onFinish:function(e){return a((n=Object(l.a)({},t,{},e),function(e){e(R(!0)),e(B(n));var t=n.tn,a=n.ring,r=n.skill,c=n.modifiers;N({uri:"/public/ffg/l5r/rolls/create",body:{tn:t,ring:a,skill:r,modifiers:c},success:function(t){e(L(t.dices)),e(R(!1))}})}));var n},values:t,loading:d}),m&&r.a.createElement(r.a.Fragment,null,!g&&r.a.createElement(r.a.Fragment,null,o.includes("distinction")&&r.a.createElement(Le,{dices:n,onFinish:function(e){return a(A(t,e,"distinction"))},loading:d}),o.includes("adversity")&&r.a.createElement(Ye,{dices:n,onFinish:function(e){return a(A(t,e,"adversity"))},loading:d})),g&&r.a.createElement(r.a.Fragment,null,p?r.a.createElement(r.a.Fragment,null,!b&&r.a.createElement(Ne,{dices:n,max:y?s+1:s,onFinish:function(e){return a(M(t,e))},compromised:v,trulyCompromised:h,loading:d}),b&&r.a.createElement(Te,{dices:n,onFinish:function(e){return a(M(t,e))},compromised:v,loading:d})):r.a.createElement(r.a.Fragment,null,r.a.createElement(De,{dices:n,trulyCompromised:h}),r.a.createElement(Be,{dices:f,tn:c}),r.a.createElement(E.a,{type:"primary",onClick:function(){return a(q())}},"Reroll"))))))},qe=a(365),Ae=a(372),Me=a(195),Ge=a.n(Me),He=a(98),Je=a.n(He),We=qe.a.Header,Qe=qe.a.Content,Ue=qe.a.Footer,Ve=function(e){var t=e.user,a=e.children;return r.a.createElement(qe.a,{className:Je.a.layout},r.a.createElement(We,null,r.a.createElement(Ae.a,{theme:"dark",mode:"horizontal"},r.a.createElement(Ae.a.Item,{className:Je.a.logo},r.a.createElement("a",{href:"/"},r.a.createElement("img",{alt:"Logo",src:Ge.a}))),r.a.createElement(Ae.a.Item,null,r.a.createElement("a",{href:"/"},"Roll")),r.a.createElement(Ae.a.Item,{className:Je.a.login},t?r.a.createElement("a",{href:"/user/profile"},t.name):r.a.createElement("a",{href:"/login"},"Login")))),r.a.createElement(Qe,null,a),r.a.createElement(Ue,{className:Je.a.footer},"Sakkaku Project / 2020 / ",r.a.createElement("a",{href:"mailto:contact.sakkaku@gmail.com"},"Issue? Suggestion?")))},ze=function(){var e=Object(n.useState)(),t=Object(o.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)((function(){T({uri:"/user",success:function(e){c(e)},error:function(e){}})}),[]),r.a.createElement(Ve,{user:a},r.a.createElement(Re,null))},Ke=Object(w.a)({reducer:{roll:H}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(_.a,{store:Ke},r.a.createElement(ze,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},84:function(e,t,a){e.exports={dice:"Dices_dice__cqowQ",selectable:"Dices_selectable__2UH3q",selected:"Dices_selected__1Gb1I",unselectable:"Dices_unselectable__KQSGp",rerolled:"Dices_rerolled__2e0qS"}},98:function(e,t,a){e.exports={layout:"Layout_layout__UFIxE",logo:"Layout_logo__1Oa8g",footer:"Layout_footer__1d2pN",login:"Layout_login__2luPa"}}},[[202,1,2]]]);
//# sourceMappingURL=main.e2dbbe54.chunk.js.map