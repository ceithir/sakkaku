(this.webpackJsonpsakkaku=this.webpackJsonpsakkaku||[]).push([[0],{146:function(e,t,n){e.exports={layout:"roller_layout__2TyHW"}},147:function(e,t,n){e.exports={submit:"Intent_submit__3pMAY"}},156:function(e,t,n){e.exports=n.p+"static/media/black.f14fed51.png"},157:function(e,t,n){e.exports=n.p+"static/media/blackot.3a5ad7bb.png"},158:function(e,t,n){e.exports=n.p+"static/media/blackst.3fad8195.png"},159:function(e,t,n){e.exports=n.p+"static/media/blacket.f0ca3076.png"},160:function(e,t,n){e.exports=n.p+"static/media/blacko.e44a1dd0.png"},161:function(e,t,n){e.exports=n.p+"static/media/blacks.216d4546.png"},162:function(e,t,n){e.exports=n.p+"static/media/white.c24c0c51.png"},163:function(e,t,n){e.exports=n.p+"static/media/whitee.7755ca79.png"},164:function(e,t,n){e.exports=n.p+"static/media/whiteet.d10cd0cc.png"},165:function(e,t,n){e.exports=n.p+"static/media/whiteo.1e81fee0.png"},166:function(e,t,n){e.exports=n.p+"static/media/whites.7cb9db03.png"},167:function(e,t,n){e.exports=n.p+"static/media/whiteso.f76a057b.png"},168:function(e,t,n){e.exports=n.p+"static/media/whitest.05051e66.png"},196:function(e,t,n){e.exports=n(355)},201:function(e,t,n){},202:function(e,t,n){},355:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(15),c=n.n(r),o=(n(201),n(202),n(40)),l=n(146),s=n.n(l),u=n(358),d=n(362),m=n(363),p=n(361),f=n(364),b=n(128),g=n(147),v=n.n(g),E={labelCol:{span:6},wrapperCol:{span:18}},h={labelCol:{span:0},wrapperCol:{span:24}},y=function(e){var t=e.completed,n=e.onFinish,a=e.values;return i.a.createElement(u.a,Object.assign({},E,{initialValues:a,onFinish:function(e){n(Object(o.a)({},e,{modifiers:[e.modifier,e.compromised&&"compromised"].filter(Boolean)}))}}),i.a.createElement(u.a.Item,{label:"Description",name:"description",rules:[{required:!0,message:"Roll description is required"}]},i.a.createElement(d.a,{disabled:t})),i.a.createElement(u.a.Item,{label:"TN",name:"tn",rules:[{required:!0}]},i.a.createElement(m.a,{disabled:t,min:1})),i.a.createElement(u.a.Item,{label:"Ring",name:"ring",rules:[{required:!0}]},i.a.createElement(m.a,{disabled:t,min:1,max:5})),i.a.createElement(u.a.Item,{label:"Skill",name:"skill",rules:[{required:!0}]},i.a.createElement(m.a,{disabled:t,min:0,max:5})),i.a.createElement(u.a.Item,{label:"Modifier",name:"modifier"},i.a.createElement(p.a.Group,{disabled:t},i.a.createElement(p.a.Button,{value:"none"},"None"),i.a.createElement(p.a.Button,{value:"distinction"},"Distinction"),i.a.createElement(p.a.Button,{value:"adversity"},"Adversity"))),i.a.createElement(u.a.Item,{label:"Compromised?",name:"compromised",valuePropName:"checked"},i.a.createElement(f.a,{disabled:t})),!t&&i.a.createElement(u.a.Item,h,i.a.createElement(b.a,{type:"primary",htmlType:"submit",className:v.a.submit},"Roll")))},k=n(89),x=n(124),O=n.n(x),j=n(155),w=n(116),_=Object(w.b)({name:"roll",initialState:{description:"Example",tn:2,ring:2,skill:2,modifiers:[],dices:[],metadata:{}},reducers:{softReset:function(e){e.dices=[],e.metadata={}},setParameters:function(e,t){var n=t.payload,a=n.description,i=n.tn,r=n.ring,c=n.skill,o=n.modifiers,l=n.compromised;e.description=a,e.tn=i,e.ring=r,e.skill=c,e.modifiers=o,e.compromised=l},updateDices:function(e,t){e.dices=t.payload},setMetadata:function(e,t){e.metadata=t.payload}}}),C=_.actions,S=C.setParameters,F=C.updateDices,I=C.setMetadata,D=_.actions.softReset,q=function(){var e=Object(j.a)(O.a.mark((function e(t,n,a){var i,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat("/api").concat(t),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)});case 3:if(i=e.sent,[200,201,204].includes(i.status)){e.next=6;break}throw new Error;case 6:return e.next=8,i.json();case 8:r=e.sent,a(r),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("TODO");case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,n,a){return e.apply(this,arguments)}}(),N=function(e,t,n){return function(a){var i=e.tn,r=e.ring,c=e.skill,o=e.modifiers,l=e.dices;q("/public/ffg/l5r/rolls/reroll",{roll:{parameters:{tn:i,ring:r,skill:c,modifiers:o},dices:l},positions:t,modifier:n},(function(e){a(F(e.dices)),a(I(e.metadata))}))}},B=function(e,t){return function(n){var a=e.tn,i=e.ring,r=e.skill,c=e.modifiers,o=e.dices,l=e.metadata;q("/public/ffg/l5r/rolls/keep",{roll:{parameters:{tn:a,ring:i,skill:r,modifiers:c},dices:o,metadata:l},positions:t},(function(e){n(F(e.dices))}))}},T=function(e){return e.roll},Y=_.reducer,M=n(356),R=n(66),P=n(67),A=n(72),G=n(357),J=n(81),W=n.n(J),H=n(3),Q=n.n(H),K=n(360),U=n(156),V=n.n(U),$=n(157),z=n.n($),L=n(158),X=n.n(L),Z=n(159),ee=n.n(Z),te=n(160),ne=n.n(te),ae=n(161),ie=n.n(ae),re=n(162),ce=n.n(re),oe=n(163),le=n.n(oe),se=n(164),ue=n.n(se),de=n(165),me=n.n(de),pe=n(166),fe=n.n(pe),be=n(167),ge=n.n(be),ve=n(168),Ee=n.n(ve),he=function(e){var t=e.type,n=e.value,a=n.opportunity,i=n.strife,r=n.success,c=n.explosion;return"skill"===t?c?i?ue.a:le.a:r?a?ge.a:i?Ee.a:fe.a:a?me.a:ce.a:i?c?ee.a:r?X.a:z.a:r?ie.a:a?ne.a:V.a},ye=function(e){var t=e.dice,n=function(e){var t=e.value,n=t.opportunity,a=t.strife,i=t.success,r=t.explosion;return[n&&"Opportunity: ".concat(n),i&&"Success: ".concat(i),r&&"Explosion: ".concat(r),a&&"Strife: ".concat(a)].filter(Boolean).join("; ")||"Nothing"}(t);return i.a.createElement(K.a,{src:he(t),alt:n,title:n,preview:!1})},ke=function(e){var t=e.dices;if(!(null===t||void 0===t?void 0:t.length))return null;var n=t.map((function(e,t){return{key:t.toString(),dice:e,selectable:e.selectable,selected:e.selected,toggle:e.toggle,disabled:e.disabled}}));return i.a.createElement(G.b,{grid:{gutter:0,column:10},dataSource:n,renderItem:function(e){var t,n=e.key,a=e.dice,r=e.selectable,c=e.selected,o=e.toggle,l=e.disabled;return i.a.createElement(G.b.Item,{key:n,className:Q()(W.a.dice,(t={},Object(A.a)(t,W.a.selectable,r),Object(A.a)(t,W.a.selected,c),Object(A.a)(t,W.a.unselectable,l),Object(A.a)(t,W.a.rerolled,"rerolled"===a.status),t)),onClick:r?o:void 0},i.a.createElement(ye,{dice:a}))}})},xe=n(359),Oe=xe.a.Paragraph,je=function(e){var t=e.dices,n=e.text,a=e.footer;return i.a.createElement("div",null,i.a.createElement(Oe,null,n),i.a.createElement(ke,{dices:t}),a)},we=function(e){var t=e.dices,n=e.max,r=e.onFinish,c=e.compromised,l=e.trulyCompromised,s=Object(a.useState)([]),u=Object(P.a)(s,2),d=u[0],m=u[1],p=n>d.length,f=l?"You cannot keep any dice due to being compromised.":"You can choose up to ".concat(n," dice").concat(n>1?"s":""," to keep (min 1).");return i.a.createElement(je,{text:f,dices:t.map((function(e,t){var n=d.includes(t),a="pending"===e.status&&(!c||!e.value.strife),i=(n||p)&&a;return Object(o.a)({},e,{selectable:i,selected:n,disabled:!i,toggle:function(){return function(e){return d.includes(e)?m(d.filter((function(t){return t!==e}))):m([].concat(Object(R.a)(d),[e]))}(t)}})})),footer:(d.length>=1||l)&&i.a.createElement(b.a,{type:"primary",onClick:function(){return r(d)}},"Continue")})},_e=function(e){var t=e.dices,n=e.onFinish,r=e.compromised,c=Object(a.useState)([]),l=Object(P.a)(c,2),s=l[0],u=l[1];return i.a.createElement(je,{text:"Select which explosions you wish to keep (if any):",dices:t.map((function(e,t){var n="pending"===e.status&&(!r||!e.value.strife);return Object(o.a)({},e,{selectable:n,selected:"kept"===e.status||s.includes(t),disabled:!n&&"kept"!==e.status,toggle:function(){return function(e){return s.includes(e)?u(s.filter((function(t){return t!==e}))):u([].concat(Object(R.a)(s),[e]))}(t)}})})),footer:i.a.createElement(b.a,{type:"primary",onClick:function(){return n(s)}},"Continue")})},Ce=function(e){var t=e.dices,n=e.trulyCompromised?"You couldn't keep any dice due to being compromised.":"You have kept:";return i.a.createElement(je,{text:n,dices:t.map((function(e){var t="kept"===e.status;return Object(o.a)({},e,{disabled:!t,selected:t})}))})},Se=xe.a.Text,Fe=function(e){var t=e.dices,n=e.tn,a=[{type:"Successes",count:t.reduce((function(e,t){return e+(t.value.explosion||0)+(t.value.success||0)}),0),target:n},{type:"Strifes",count:t.reduce((function(e,t){return e+(t.value.strife||0)}),0)},{type:"Opportunities",count:t.reduce((function(e,t){return e+(t.value.opportunity||0)}),0)}];return i.a.createElement(G.b,{grid:{gutter:16,column:3},dataSource:a,renderItem:function(e){var t=e.type,n=e.count,a=e.target;return i.a.createElement(G.b.Item,null,i.a.createElement(Se,{strong:!0,type:a&&(n>=a?"success":"warning")},"".concat(t,": ").concat(n)),a&&i.a.createElement(Se,null," (required: ".concat(a,")")))}})},Ie=function(e){var t=e.dices,n=e.onFinish,r=Object(a.useState)([]),c=Object(P.a)(r,2),l=c[0],s=c[1];return i.a.createElement(je,{text:"You can choose up to ".concat(2," dices to reroll."),dices:t.map((function(e,t){var n=l.includes(t),a=n||l.length<2;return Object(o.a)({},e,{selectable:a,selected:n,disabled:!a,toggle:function(){return function(e){return l.includes(e)?s(l.filter((function(t){return t!==e}))):s([].concat(Object(R.a)(l),[e]))}(t)}})})),footer:i.a.createElement(b.a,{type:"primary",onClick:function(){return n(l)}},"Continue")})},De=function(e){var t=e.dices,n=e.onFinish,r=Object(a.useState)([]),c=Object(P.a)(r,2),l=c[0],s=c[1],u=t.filter((function(e){var t=e.value;return t.success||t.explosion})),d=Math.min(2,u.length);return i.a.createElement(je,{text:"You must reroll two success dices (if possible).",dices:t.map((function(e,t){var n=l.includes(t),a=(e.value.success||e.value.explosion)&&(n||l.length<2);return Object(o.a)({},e,{selectable:a,selected:n,disabled:!a,toggle:function(){return function(e){return l.includes(e)?s(l.filter((function(t){return t!==e}))):s([].concat(Object(R.a)(l),[e]))}(t)}})})),footer:l.length>=d&&i.a.createElement(b.a,{type:"primary",onClick:function(){return n(l)}},"Continue")})},qe=function(){var e,t=Object(k.c)(T),n=Object(k.b)(),a=t.dices,r=t.tn,c=t.metadata,l=t.modifiers,u=t.ring,d=t.compromised,m=a.length>0,p=m&&a.some((function(e){return"pending"===e.status})),f=a.filter((function(e){return"kept"===e.status})),g=f.length>0,v=(null===c||void 0===c||null===(e=c.rerolls)||void 0===e?void 0:e.length)||!(l.includes("adversity")||l.includes("distinction")),E=d&&m&&v&&!g&&a.filter((function(e){return"pending"===e.status})).every((function(e){return e.value.strife}));return i.a.createElement("div",{className:s.a.layout},i.a.createElement(M.a,null,i.a.createElement(y,{completed:m,onFinish:function(e){return n((a=Object(o.a)({},t,{},e),function(e){e(S(a));var t=a.tn,n=a.ring,i=a.skill,r=a.modifiers;q("/public/ffg/l5r/rolls/create",{tn:t,ring:n,skill:i,modifiers:r},(function(t){e(F(t.dices))}))}));var a},values:t}),m&&i.a.createElement(i.a.Fragment,null,!v&&i.a.createElement(i.a.Fragment,null,l.includes("distinction")&&i.a.createElement(Ie,{dices:a,onFinish:function(e){return n(N(t,e,"distinction"))}}),l.includes("adversity")&&i.a.createElement(De,{dices:a,onFinish:function(e){return n(N(t,e,"adversity"))}})),v&&i.a.createElement(i.a.Fragment,null,p?i.a.createElement(i.a.Fragment,null,!g&&i.a.createElement(we,{dices:a,max:u,onFinish:function(e){return n(B(t,e))},compromised:d,trulyCompromised:E}),g&&i.a.createElement(_e,{dices:a,onFinish:function(e){return n(B(t,e))},compromised:d})):i.a.createElement(i.a.Fragment,null,i.a.createElement(Ce,{dices:a,trulyCompromised:E}),i.a.createElement(Fe,{dices:f,tn:r}),i.a.createElement(b.a,{type:"primary",onClick:function(){return n(D())}},"Reroll"))))))},Ne=function(){return i.a.createElement(qe,null)},Be=Object(w.a)({reducer:{roll:Y}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(k.a,{store:Be},i.a.createElement(Ne,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},81:function(e,t,n){e.exports={dice:"Dices_dice__cqowQ",selectable:"Dices_selectable__2UH3q",selected:"Dices_selected__1Gb1I",unselectable:"Dices_unselectable__KQSGp",rerolled:"Dices_rerolled__2e0qS"}}},[[196,1,2]]]);
//# sourceMappingURL=main.ac9a9c01.chunk.js.map